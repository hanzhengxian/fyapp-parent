<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_user -->
    <resultMap id="RM-USER" class="com.onway.fyapp.common.dal.dataobject.UserDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="openId" column="OPEN_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="unionId" column="UNION_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="headUrl" column="HEAD_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="cell" column="CELL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="nickName" column="NICK_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sex" column="SEX"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="age" column="AGE"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="certNo" column="CERT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="birthday" column="BIRTHDAY"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="ageGroup" column="AGE_GROUP"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="comName" column="COM_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="userLevel" column="USER_LEVEL"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="recommendUserId" column="RECOMMEND_USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendUserType" column="RECOMMEND_USER_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delFlg" column="DEL_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="isNew" column="IS_NEW"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="loginPsw" column="LOGIN_PSW"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="canWithdraw" column="CAN_WITHDRAW"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="realName" column="REAL_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="comAddress" column="COM_ADDRESS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="profession" column="PROFESSION"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="comfirmMsg" column="COMFIRM_MSG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="qrCode" column="QR_CODE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="erpNo" column="ERP_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisUserDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisUserDAO.selectUserList -->
			 <select id="MS-USER-SELECT-USER-LIST" resultClass="java.util.HashMap">
	        select
					hqyt_user.ID id,
					hqyt_user.USER_ID userId,
					hqyt_user.OPEN_ID openId,
					hqyt_user.HEAD_URL headUrl,
					hqyt_user.CELL cell,
					hqyt_user.NICK_NAME nickName,
					hqyt_user.SEX sex,
					hqyt_user.AGE age,
					hqyt_user.CERT_NO certNo,
					hqyt_user.BIRTHDAY birthday,
					hqyt_user.AGE_GROUP ageGroup,
					hqyt_user.COM_NAME comName,
					hqyt_user.DEL_FLG delFlg,
					hqyt_user.LOGIN_PSW loginPsw,
					hqyt_user.USER_LEVEL userLevel,
					hqyt_user.REAL_NAME realName,
					hqyt_user.COM_ADDRESS comAddress,
					hqyt_user.PROFESSION profession,
					hqyt_user.ERP_NO erpNo,
					<!-- ROLE role, -->
					ru.USER_ID recommendUserId,
					ru.NICK_NAME recommendNickName,
					ru.CELL recommendUserCell,
					ru.REAL_NAME recommendRealName,
					hqyt_user.GMT_CREATE gmtCreate,
					hqyt_user.GMT_MODIFIED gmtModified,
					hqyt_account.ACCOUNT_NO accountNo,
					hqyt_account.LINK_ID teamId,
					hqyt_account.DEVOTE_AMOUNT devoteAmount,
					hqyt_account.HU_BALANCE huBalance,
					hqyt_account.HU_POINT huPoint,
					hqyt_account.RE_POINT rePoint
				FROM hqyt_user
				LEFT JOIN hqyt_account ON hqyt_account.LINK_ID = USER_ID 
				LEFT JOIN hqyt_user ru ON ru.USER_ID = hqyt_user.RECOMMEND_USER_ID
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="nickName"> 
					hqyt_user.NICK_NAME like "%$nickName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="realName"> 
					hqyt_user.REAL_NAME like "%$realName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cell"> 
					hqyt_user.CELL like "%$cell$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="sex"> 
					hqyt_user.SEX = #sex#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userLevel"> 
					hqyt_user.USER_LEVEL = #userLevel#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="delFlg"> 
					hqyt_user.DEL_FLG = #delFlg#
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hqyt_user.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hqyt_user.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="recommendUserCell"> 
					ru.CELL like "%$recommendUserCell$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userId"> 
					hqyt_user.USER_ID like "%$userId$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendUserId"> 
					ru.USER_ID like "%$recommendUserId$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendNickName"> 
					ru.NICK_NAME like "%$recommendNickName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendRealName"> 
					ru.REAL_NAME like "%$recommendRealName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="erpNo"> 
					hqyt_user.ERP_NO like "%$erpNo$%"
				</isNotEmpty>
		        
				ORDER BY hqyt_user.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.queryListCount -->
			 <select id="MS-USER-QUERY-LIST-COUNT" resultClass="int">
	        select 
				COUNT(1)
			FROM hqyt_user
				LEFT JOIN hqyt_account ON hqyt_account.LINK_ID = USER_ID 
				LEFT JOIN hqyt_user ru ON ru.USER_ID = hqyt_user.RECOMMEND_USER_ID
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="nickName"> 
					hqyt_user.NICK_NAME like "%$nickName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="realName"> 
					hqyt_user.REAL_NAME like "%$realName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cell"> 
					hqyt_user.CELL like "%$cell$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="sex"> 
					hqyt_user.SEX = #sex#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userLevel"> 
					hqyt_user.USER_LEVEL = #userLevel#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="delFlg"> 
					hqyt_user.DEL_FLG = #delFlg#
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hqyt_user.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hqyt_user.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="recommendUserCell"> 
					ru.CELL like "%$recommendUserCell$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userId"> 
					hqyt_user.USER_ID like "%$userId$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendUserId"> 
					ru.USER_ID like "%$recommendUserId$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendNickName"> 
					ru.NICK_NAME like "%$recommendNickName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="recommendRealName"> 
					ru.REAL_NAME like "%$recommendRealName$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="erpNo"> 
					hqyt_user.ERP_NO like "%$erpNo$%"
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.selectByUserId -->
			 <select id="MS-USER-SELECT-BY-USER-ID" resultMap="RM-USER">
	    <![CDATA[
        select * from hqyt_user where (USER_ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisUserDAO.finduserbyid -->
			 <select id="MS-USER-FINDUSERBYID" resultMap="RM-USER">
	    <![CDATA[
        select * from hqyt_user where (USER_ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisUserDAO.findteamuser -->
			 <select id="MS-USER-FINDTEAMUSER" resultMap="RM-USER">
	        select 
					*
				FROM 
					hqyt_user 
				WHERE 
					hqyt_user.USER_ID in( select hqyt_user .USER_ID from hqyt_user left join hqyt_team_user on hqyt_user.USER_ID=hqyt_team_user.TEAM_USER_ID where hqyt_team_user.TEAM_USER_ID is null)
		        
		        <isNotEmpty prepend="and" property="fnickName"> 
					 hqyt_user.NICK_NAME like '%$fnickName$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="fcell"> 
					 hqyt_user.CELL like '%$fcell$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="frealName"> 
					 hqyt_user.REAL_NAME like '%$frealName$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="" property="limit"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.findteamuserCount -->
			 <select id="MS-USER-FINDTEAMUSER-COUNT" resultClass="int">
	        select 
					COUNT(1)
				FROM 
					hqyt_user 
				WHERE 
					hqyt_user.USER_ID in( select hqyt_user .USER_ID from hqyt_user left join hqyt_team_user on hqyt_user.USER_ID=hqyt_team_user.TEAM_USER_ID where hqyt_team_user.TEAM_USER_ID is null)
		        
		        <isNotEmpty prepend="and" property="fnickName"> 
					 hqyt_user.NICK_NAME like '%$fnickName$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="fcell"> 
					 hqyt_user.CELL like '%$fcell$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="frealName"> 
					 hqyt_user.REAL_NAME like '%$frealName$%'
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.finduserbyteamid -->
			 <select id="MS-USER-FINDUSERBYTEAMID" resultClass="java.util.HashMap">
	        select 
					hqyt_user.ID id,
					hqyt_user.USER_ID userId,
					hqyt_user.OPEN_ID openId,
					hqyt_user.HEAD_URL headUrl,
					hqyt_user.CELL cell,
					hqyt_user.NICK_NAME nickName,
					hqyt_user.REAL_NAME realName,
					hqyt_user.SEX sex,
					hqyt_user.AGE age,
					hqyt_user.CERT_NO certNo,
					hqyt_user.BIRTHDAY birthday,
					hqyt_user.COM_NAME comName,
					hqyt_user.USER_LEVEL userLevel,
					hqyt_user.RECOMMEND_USER_ID recommendUuserId,
					hqyt_user.RECOMMEND_USER_TYPE recommendUserType,
					hqyt_user.DEL_FLG delFlg,
					hqyt_user.IS_NEW isNew,
					hqyt_user.LOGIN_PSW loginPsw,
					hqyt_user.CAN_WITHDRAW canWithdraw,
					hqyt_user.GMT_CREATE gmtCreate,
					hqyt_user.GMT_MODIFIED gmtModified,
					hqyt_user.ERP_NO erpNo,
					hqyt_team_user.TEAM_ID teamId,
					hqyt_team_user.TEAM_USER_ID teamUserId,
					hqyt_team_user.TEAM_LEDER teamLeder
				FROM 
					hqyt_user 
				LEFT JOIN hqyt_team_user  ON hqyt_team_user.TEAM_USER_ID= hqyt_user.USER_ID
				WHERE
					hqyt_team_user.TEAM_ID=#teamId#
				<isNotEmpty prepend="and" property="fnickName"> 
					 hqyt_user.NICK_NAME like "%$fnickName$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="frealName"> 
					 hqyt_user.REAL_NAME like "%$frealName$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="fcell"> 
					 hqyt_user.CELL like "%$fcell$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="froleType"> 
					 hqyt_team_user.TEAM_LEDER = #froleType#
				</isNotEmpty>
				order by hqyt_team_user.TEAM_LEDER ASC
				<isNotEmpty prepend="" property="limit"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.finduserbyteamidCount -->
			 <select id="MS-USER-FINDUSERBYTEAMID-COUNT" resultClass="int">
	        select 
					COUNT(1)
				FROM 
					hqyt_user 
				LEFT JOIN hqyt_team_user  ON hqyt_team_user.TEAM_USER_ID= hqyt_user.USER_ID
				WHERE
					hqyt_team_user.TEAM_ID=#teamId#
				<isNotEmpty prepend="and" property="fnickName"> 
					 hqyt_user.NICK_NAME like "%$fnickName$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="frealName"> 
					 hqyt_user.REAL_NAME like "%$frealName$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="fcell"> 
					 hqyt_user.CELL like "%$fcell$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="froleType"> 
					 hqyt_team_user.TEAM_LEDER = #froleType#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.queryAllUser -->
			 <select id="MS-USER-QUERY-ALL-USER" resultMap="RM-USER">
	        select
					*
				FROM hqyt_user
				limit #offset#,#limit#
    </select>

    <!-- mapped statement for IbatisUserDAO.queryAllUserCount -->
			 <select id="MS-USER-QUERY-ALL-USER-COUNT" resultClass="int">
	    <![CDATA[
        select COUNT(1) from hqyt_user
    ]]>
    </select>

    <!-- mapped statement for IbatisUserDAO.updateUserLevel -->
    <update id="MS-USER-UPDATE-USER-LEVEL">
    <![CDATA[
        update hqyt_user set USER_LEVEL=#userLevel#, GMT_MODIFIED=CURRENT_TIMESTAMP where (USER_ID = #userId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisUserDAO.selectByUserCell -->
			 <select id="MS-USER-SELECT-BY-USER-CELL" resultMap="RM-USER">
	    <![CDATA[
        select * from hqyt_user where (CELL = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisUserDAO.modifyUserStatus -->
    <update id="MS-USER-MODIFY-USER-STATUS">
    <![CDATA[
        update hqyt_user set DEL_FLG=#delFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where (USER_ID = #userId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisUserDAO.searchByUserIdOrOpenId -->
			 <select id="MS-USER-SEARCH-BY-USER-ID-OR-OPEN-ID" resultMap="RM-USER">
	        SELECT
		        ID,
				USER_ID,
				OPEN_ID,
				HEAD_URL,
				CELL,
				NICK_NAME,
				SEX,
				AGE,
				CERT_NO,
				BIRTHDAY,
				COM_NAME,
				USER_LEVEL,
				RECOMMEND_USER_ID,
				RECOMMEND_USER_TYPE,
				DEL_FLG,
				IS_NEW,
				LOGIN_PSW,
				CAN_WITHDRAW,
				REAL_NAME,
				COM_ADDRESS,
				PROFESSION,
				COMFIRM_MSG,
				QR_CODE,
				ERP_NO,
				GMT_CREATE,
				GMT_MODIFIED
			FROM hqyt_user
            WHERE 1=1
            <isNotEmpty property="userId" prepend="and">
	               USER_ID = #userId#
	        </isNotEmpty>
	        <isNotEmpty property="openId" prepend="and">
	               OPEN_ID = #openId#
	        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisUserDAO.updateUserRealName -->
    <update id="MS-USER-UPDATE-USER-REAL-NAME">
    <![CDATA[
        update hqyt_user set REAL_NAME=#realName#, ERP_NO=#erpNo#, GMT_MODIFIED=CURRENT_TIMESTAMP where (USER_ID = #userId#)
    ]]>
    </update>

</sqlMap>