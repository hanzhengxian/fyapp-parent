<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_product -->
    <resultMap id="RM-PRODUCT" class="com.onway.fyapp.common.dal.dataobject.ProductDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="productId" column="PRODUCT_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productName" column="PRODUCT_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="showOld" column="SHOW_OLD"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productArea" column="PRODUCT_AREA"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sales" column="SALES"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="mounthSales" column="MOUNTH_SALES"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="brand" column="BRAND"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="manufacturer" column="MANUFACTURER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="licenseNo" column="LICENSE_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="type" column="TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="fatherCate" column="FATHER_CATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="childCate" column="CHILD_CATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="fatherEfectCate" column="FATHER_EFECT_CATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="childEfectCate" column="CHILD_EFECT_CATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delFlg" column="DEL_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="proType" column="PRO_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="canBuy" column="CAN_BUY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="onSale" column="ON_SALE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="erpNo" column="ERP_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productAreaSource" column="PRODUCT_AREA_SOURCE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="isNew" column="IS_NEW"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="pickType" column="PICK_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="attenMemo" column="ATTEN_MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="keepWay" column="KEEP_WAY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="keepDate" column="KEEP_DATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="userLevel" column="USER_LEVEL"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="maxDiscount" column="MAX_DISCOUNT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="unit" column="UNIT"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="specification" column="SPECIFICATION"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="proName" column="PRO_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="proZjm" column="PRO_ZJM"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="rankNum" column="RANK_NUM"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="businessCategory" column="BUSINESS_CATEGORY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="freeLuagger" column="FREE_LUAGGER"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisProductDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisProductDAO.insert -->
    <insert id="MS-PRODUCT-INSERT">
    <![CDATA[
        insert into hqyt_product(PRODUCT_ID,PRODUCT_NAME,PRO_NAME,PRO_ZJM,SHOW_OLD,PRODUCT_AREA,SALES,MOUNTH_SALES,BRAND,MANUFACTURER,LICENSE_NO,TYPE,FATHER_CATE,CHILD_CATE,FATHER_EFECT_CATE,CHILD_EFECT_CATE,DEL_FLG,PRO_TYPE,CAN_BUY,ON_SALE,ERP_NO,IS_NEW,PICK_TYPE,USER_LEVEL,MAX_DISCOUNT,UNIT,PRODUCT_AREA_SOURCE,ATTEN_MEMO,KEEP_WAY,KEEP_DATE,SPECIFICATION,RANK_NUM,BUSINESS_CATEGORY,FREE_LUAGGER,CREATER,GMT_CREATE,GMT_MODIFIED) values (#productId#, #productName#, #proName#, #proZjm#, #showOld#, #productArea#, #sales#, #mounthSales#, #brand#, #manufacturer#, #licenseNo#, #type#, #fatherCate#, #childCate#, #fatherEfectCate#, #childEfectCate#, #delFlg#, #proType#, #canBuy#, #onSale#, #erpNo#, #isNew#, #pickType#, #userLevel#, #maxDiscount#, #unit#, #productAreaSource#, #attenMemo#, #keepWay#, #keepDate#, #specification#, #rankNum#, #businessCategory#, #freeLuagger#, #creater#, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisProductDAO.updateByProdId -->
    <update id="MS-PRODUCT-UPDATE-BY-PROD-ID">
    <![CDATA[
        update hqyt_product set PRODUCT_NAME=#productName#, PRO_NAME=#proName#, PRO_ZJM=#proZjm#, SHOW_OLD=#showOld#, PRODUCT_AREA=#productArea#, SALES=#sales#, MOUNTH_SALES=#mounthSales#, BRAND=#brand#, MANUFACTURER=#manufacturer#, LICENSE_NO=#licenseNo#, TYPE=#type#, FATHER_CATE=#fatherCate#, CHILD_CATE=#childCate#, FATHER_EFECT_CATE=#fatherEfectCate#, CHILD_EFECT_CATE=#childEfectCate#, DEL_FLG=#delFlg#, PRO_TYPE=#proType#, CAN_BUY=#canBuy#, ERP_NO=#erpNo#, ON_SALE=#onSale#, IS_NEW=#isNew#, PICK_TYPE=#pickType#, USER_LEVEL=#userLevel#, MAX_DISCOUNT=#maxDiscount#, UNIT=#unit#, PRODUCT_AREA_SOURCE=#productAreaSource#, ATTEN_MEMO=#attenMemo#, KEEP_WAY=#keepWay#, KEEP_DATE=#keepDate#, SPECIFICATION=#specification#, RANK_NUM=#rankNum#, BUSINESS_CATEGORY=#businessCategory#, FREE_LUAGGER=#freeLuagger#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (PRODUCT_ID = #productId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.selectByProdId -->
			 <select id="MS-PRODUCT-SELECT-BY-PROD-ID" resultMap="RM-PRODUCT">
	    <![CDATA[
        select * from hqyt_product where ((1 = 1) AND (PRODUCT_ID = #value#))
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.queryGoods -->
			 <select id="MS-PRODUCT-QUERY-GOODS" resultClass="java.util.HashMap">
	        SELECT
					hqyt_product.ID id,
					hqyt_product.PRODUCT_ID productId,
					hqyt_product.PRODUCT_NAME productName,
					hqyt_product.PRO_NAME proName,
					hqyt_product.PRO_ZJM proZjm,
					hqyt_product.SHOW_OLD showOld,
					hqyt_product.PRODUCT_AREA productArea,
					hqyt_product.SALES sales,
					hqyt_product.MOUNTH_SALES mounthSales,
					hqyt_product.BRAND brand,
					hqyt_product.MANUFACTURER manufacturer,
					hqyt_product.LICENSE_NO licenseNo,
					hqyt_product.TYPE type,
					hqyt_product.FATHER_CATE fatherCate,
					hqyt_product.CHILD_CATE childCate,
					hqyt_product.FATHER_EFECT_CATE fatherEfectCate,
					hqyt_product.CHILD_EFECT_CATE childEfectCate,
					hqyt_product.DEL_FLG delFlg,
					hqyt_product.PRO_TYPE proType,
					hqyt_product.CAN_BUY canBuy,
					hqyt_product.ON_SALE onSale,
					hqyt_product.ERP_NO erpNo,
					hqyt_product.IS_NEW isNew,
					hqyt_product.PICK_TYPE pickType,
					hqyt_product.RANK_NUM rankNum,
					hqyt_product.BUSINESS_CATEGORY businessCategory,
					hqyt_product.FREE_LUAGGER freeLuggage,
					<!-- hqyt_product.PAY_TYPE payType, -->
					hqyt_product.USER_LEVEL userLevel,
					hqyt_product.GMT_CREATE gmtCreate,
					hqyt_product.GMT_MODIFIED gmtModified,
					hqyt_product.SPECIFICATION specification,
					hqyt_product.UNIT unit,
					hqyt_product_team.TEAM_ID teamId,
					hqyt_team.TEAM_NAME teamName,
					hqyt_team.TEAM_TYPE teamType,
					scu.USERNAME creater,
					smu.USERNAME modifier
				FROM
					hqyt_product
				LEFT JOIN hqyt_product_team ON hqyt_product_team.PRODUCT_ID = hqyt_product.PRODUCT_ID
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = hqyt_product_team.TEAM_ID
				LEFT JOIN sys_role_user scu ON scu.USER_ID = hqyt_product.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = hqyt_product.MODIFIER
				WHERE 1=1 
				<isNotEmpty property="productId">
	    			AND hqyt_product.PRODUCT_ID = #productId#
	    		</isNotEmpty>
				<isNotEmpty property="proType">
	    			AND hqyt_product.PRO_TYPE = #proType#
	    		</isNotEmpty>
				<isNotEmpty property="teamId">
	    			AND hqyt_product_team.TEAM_ID = #teamId#
	    		</isNotEmpty>
				<isNotEmpty property="productName">
	    			AND hqyt_product.PRODUCT_NAME like '%$productName$%'
	    		</isNotEmpty>
				<isNotEmpty property="teamName">
	    			AND hqyt_team.TEAM_NAME like '%$teamName$%'
	    		</isNotEmpty>
				<isNotEmpty property="onSale">
	    			AND hqyt_product.ON_SALE = #onSale#
	    		</isNotEmpty>
				<isNotEmpty property="canBuy">
	    			AND hqyt_product.CAN_BUY = #canBuy#
	    		</isNotEmpty>
				<isNotEmpty property="licenseNo">
	    			AND hqyt_product.LICENSE_NO = #licenseNo#
	    		</isNotEmpty>
				<isNotEmpty property="isDelete">
	    			AND hqyt_product.DEL_FLG = #isDelete#
	    		</isNotEmpty>
	    		<isNotEmpty property="erpNo">
	    			AND hqyt_product.ERP_NO like '%$erpNo$%'
	    		</isNotEmpty>
	    		
	    		<isEqual prepend="" property="hasChooseForDiscount" compareValue = "0">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	hqyt_product.PRODUCT_ID IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isEqual prepend="" property="hasChooseForDiscount" compareValue = "1">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	hqyt_product.PRODUCT_ID NOT IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        
		        <isNotEmpty property="freeLuggage">
	    			AND hqyt_product.FREE_LUAGGER = #freeLuggage#
	    		</isNotEmpty>
	    		
	    		<isNotEmpty property="barcode">
	    			AND
		    		(
						SELECT
							GROUP_CONCAT(BAR_CODE)
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
					) LIKE  "%$barcode$%"
	    		</isNotEmpty>
	    		
	    		<isEqual prepend="" property="hasStockPrice" compareValue = "1">
	    			<![CDATA[
	    			AND
		    		(
						SELECT
							TYPE
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
						GROUP BY TYPE ASC
						LIMIT 0,1
					) = '2'
					]]> 
	    		</isEqual>
	    		
	    		<isEqual prepend="" property="hasStockPrice" compareValue = "0">
	    			<![CDATA[
	    			AND
		    		(
						SELECT
							TYPE
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
						GROUP BY TYPE ASC
						LIMIT 0,1
					)  = '1' 
					]]> 
	    		</isEqual>
		        
				order by hqyt_product.DEL_FLG ASC ,hqyt_product.GMT_CREATE desc
				<isNotEmpty property="offset">
	    			LIMIT $offset$, $limit$
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductPage -->
			 <select id="MS-PRODUCT-SELECT-PRODUCT-PAGE" resultClass="java.util.HashMap">
	        SELECT
					p.*,
					i.IMG_URL,
					(SELECT MIN(GOOD_AMOUNT) FROM hqyt_stock_price WHERE GOODS_NO = p.PRODUCT_ID) AS amount,
					scu.USERNAME creater,
					smu.USERNAME modifier
				FROM
					hqyt_product p
					left join hqyt_img i on p.PRODUCT_ID = i.IMG_ID
					LEFT JOIN sys_role_user scu ON scu.USER_ID = p.CREATER
					LEFT JOIN sys_role_user smu ON smu.USER_ID = p.MODIFIER
				WHERE 1=1 
				AND i.DEL_FLG = '0' 
				AND i.IMG_FLG = '3'
				<isNotEmpty property="productId">
	    			AND p.PRODUCT_ID = #productId#
	    		</isNotEmpty>
				<isNotEmpty property="proType">
	    			AND p.PRO_TYPE = #proType#
	    		</isNotEmpty>
				<isNotEmpty property="productName">
	    			AND p.PRODUCT_NAME like "%$productName$%"
	    		</isNotEmpty>
				<isNotEmpty property="onSale">
	    			AND p.ON_SALE = #onSale#
	    		</isNotEmpty>
				<isNotEmpty property="canBuy">
	    			AND p.CAN_BUY = #canBuy#
	    		</isNotEmpty>
				<isNotEmpty property="licenseNo">
	    			AND p.LICENSE_NO = #licenseNo#
	    		</isNotEmpty>
					order by p.GMT_CREATE desc
				<isNotEmpty property="offset">
	    			LIMIT $offset$, $limit$
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductPageCount -->
			 <select id="MS-PRODUCT-SELECT-PRODUCT-PAGE-COUNT" resultClass="int">
	        SELECT
					COUNT(1)
				FROM
					hqyt_product 
				LEFT JOIN hqyt_product_team ON hqyt_product_team.PRODUCT_ID = hqyt_product.PRODUCT_ID
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = hqyt_product_team.TEAM_ID
				WHERE 1=1 
				<isNotEmpty property="productId">
	    			AND hqyt_product.PRODUCT_ID = #productId#
	    		</isNotEmpty>
				<isNotEmpty property="proType">
	    			AND hqyt_product.PRO_TYPE = #proType#
	    		</isNotEmpty>
				<isNotEmpty property="teamId">
	    			AND hqyt_product_team.TEAM_ID = #teamId#
	    		</isNotEmpty>
				<isNotEmpty property="productName">
	    			AND hqyt_product.PRODUCT_NAME like '%$productName$%'
	    		</isNotEmpty>
				<isNotEmpty property="teamName">
	    			AND hqyt_team.TEAM_NAME like '%$teamName$%'
	    		</isNotEmpty>
				<isNotEmpty property="onSale">
	    			AND hqyt_product.ON_SALE = #onSale#
	    		</isNotEmpty>
				<isNotEmpty property="canBuy">
	    			AND hqyt_product.CAN_BUY = #canBuy#
	    		</isNotEmpty>
				<isNotEmpty property="licenseNo">
	    			AND hqyt_product.LICENSE_NO = #licenseNo#
	    		</isNotEmpty>
				<isNotEmpty property="isDelete">
	    			AND hqyt_product.DEL_FLG = #isDelete#
	    		</isNotEmpty>
	    		<isNotEmpty property="erpNo">
	    			AND hqyt_product.ERP_NO like '%$erpNo$%'
	    		</isNotEmpty>
	    		<isEqual prepend="" property="hasChooseForDiscount" compareValue = "0">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	hqyt_product.PRODUCT_ID IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isEqual prepend="" property="hasChooseForDiscount" compareValue = "1">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	hqyt_product.PRODUCT_ID NOT IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isNotEmpty property="freeLuggage">
	    			AND hqyt_product.FREE_LUAGGER = #freeLuggage#
	    		</isNotEmpty>
	    		
	    		<isNotEmpty property="barcode">
	    			AND
		    		(
						SELECT
							GROUP_CONCAT(BAR_CODE)
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
					) LIKE  "%$barcode$%"
	    		</isNotEmpty>
	    		
	    		<isEqual prepend="" property="hasStockPrice" compareValue = "1">
	    			<![CDATA[
	    			AND
		    		(
						SELECT
							TYPE
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
						GROUP BY TYPE ASC
						LIMIT 0,1
					) = '2'
					]]> 
	    		</isEqual>
	    		
	    		<isEqual prepend="" property="hasStockPrice" compareValue = "0">
	    			<![CDATA[
	    			AND
		    		(
						SELECT
							TYPE
						FROM
							hqyt_stock_price
						WHERE
							GOODS_NO = hqyt_product.PRODUCT_ID
						GROUP BY TYPE ASC
						LIMIT 0,1
					)  = '1' 
					]]> 
	    		</isEqual>
    </select>

    <!-- mapped statement for IbatisProductDAO.cleanProMounthSell -->
    <update id="MS-PRODUCT-CLEAN-PRO-MOUNTH-SELL">
    <![CDATA[
        update hqyt_product set MOUNTH_SALES=0, GMT_MODIFIED=CURRENT_TIMESTAMP
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateOnSale -->
    <update id="MS-PRODUCT-UPDATE-ON-SALE">
    <![CDATA[
        update hqyt_product set ON_SALE="1", MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (PRODUCT_ID = #productId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateDelFlg -->
    <update id="MS-PRODUCT-UPDATE-DEL-FLG">
    <![CDATA[
        update hqyt_product set DEL_FLG="1", MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.autoOnSale -->
    <update id="MS-PRODUCT-AUTO-ON-SALE">
    <![CDATA[
        update hqyt_product set ON_SALE=#onSale#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.queryGoodsById -->
			 <select id="MS-PRODUCT-QUERY-GOODS-BY-ID" resultMap="RM-PRODUCT">
	    <![CDATA[
        select * from hqyt_product where (ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.queryForProductIdArray -->
			 <select id="MS-PRODUCT-QUERY-FOR-PRODUCT-ID-ARRAY" resultClass="java.lang.String">
	        SELECT
					PRODUCT_ID
				FROM
					hqyt_product
				WHERE 1=1 
				<isNotEmpty property="productName">
	    			AND PRODUCT_NAME like "%$productName$%"
	    		</isNotEmpty>
				<isNotEmpty property="productErpNo">
	    			AND ERP_NO like "%$productErpNo$%"
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.queryAllGoods -->
			 <select id="MS-PRODUCT-QUERY-ALL-GOODS" resultMap="RM-PRODUCT">
	        SELECT
					*
				FROM
					hqyt_product
				WHERE 1=1 
				<![CDATA[
		            AND  ID >=  100
		        ]]>
				order by ID ASC
    </select>

    <!-- mapped statement for IbatisProductDAO.updateZjm -->
    <update id="MS-PRODUCT-UPDATE-ZJM">
    <![CDATA[
        update hqyt_product set PRO_ZJM=#proZjm# where (PRODUCT_ID = #productId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.queryGoodsWithBarCode -->
			 <select id="MS-PRODUCT-QUERY-GOODS-WITH-BAR-CODE" resultClass="java.util.HashMap">
	        SELECT * FROM
				(
				SELECT
					hqyt_product.ID id,
					hqyt_product.PRODUCT_ID productId,
					hqyt_product.PRODUCT_NAME productName,
					hqyt_product.PRO_NAME proName,
					hqyt_product.PRO_ZJM proZjm,
					hqyt_product.SHOW_OLD showOld,
					hqyt_product.PRODUCT_AREA productArea,
					hqyt_product.SALES sales,
					hqyt_product.MOUNTH_SALES mounthSales,
					hqyt_product.BRAND brand,
					hqyt_product.MANUFACTURER manufacturer,
					hqyt_product.LICENSE_NO licenseNo,
					hqyt_product.TYPE type,
					hqyt_product.FATHER_CATE fatherCate,
					hqyt_product.CHILD_CATE childCate,
					hqyt_product.FATHER_EFECT_CATE fatherEfectCate,
					hqyt_product.CHILD_EFECT_CATE childEfectCate,
					hqyt_product.DEL_FLG delFlg,
					hqyt_product.PRO_TYPE proType,
					hqyt_product.CAN_BUY canBuy,
					hqyt_product.ON_SALE onSale,
					hqyt_product.ERP_NO erpNo,
					hqyt_product.IS_NEW isNew,
					hqyt_product.PICK_TYPE pickType,
					hqyt_product.RANK_NUM rankNum,
					hqyt_product.BUSINESS_CATEGORY businessCategory,
					hqyt_product.FREE_LUAGGER freeLuggage,
					hqyt_product.USER_LEVEL userLevel,
					hqyt_product.GMT_CREATE gmtCreate,
					hqyt_product.GMT_MODIFIED gmtModified,
					hqyt_product_team.TEAM_ID teamId,
					hqyt_team.TEAM_NAME teamName,
					hqyt_team.TEAM_TYPE teamType,
					scu.USERNAME creater,
					smu.USERNAME modifier,
					(SELECT GROUP_CONCAT(BAR_CODE) FROM hqyt_stock_price WHERE GOODS_NO = hqyt_product_team.PRODUCT_ID) barCode
				FROM
					hqyt_product
				LEFT JOIN hqyt_product_team ON hqyt_product_team.PRODUCT_ID = hqyt_product.PRODUCT_ID
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = hqyt_product_team.TEAM_ID
				LEFT JOIN sys_role_user scu ON scu.USER_ID = hqyt_product.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = hqyt_product.MODIFIER
				) result
				WHERE 1=1 
				<isNotEmpty property="productId">
	    			AND result.productId = #productId#
	    		</isNotEmpty>
				<isNotEmpty property="proType">
	    			AND result.proType = #proType#
	    		</isNotEmpty>
				<isNotEmpty property="teamId">
	    			AND result.teamId = #teamId#
	    		</isNotEmpty>
				<isNotEmpty property="productName">
	    			AND result.productName like '%$productName$%'
	    		</isNotEmpty>
				<isNotEmpty property="teamName">
	    			AND result.teamName like '%$teamName$%'
	    		</isNotEmpty>
				<isNotEmpty property="onSale">
	    			AND result.onSale = #onSale#
	    		</isNotEmpty>
				<isNotEmpty property="canBuy">
	    			AND result.canBuy = #canBuy#
	    		</isNotEmpty>
				<isNotEmpty property="licenseNo">
	    			AND result.licenseNo = #licenseNo#
	    		</isNotEmpty>
				<isNotEmpty property="isDelete">
	    			AND result.delFlg = #isDelete#
	    		</isNotEmpty>
	    		<isNotEmpty property="erpNo">
	    			AND result.erpNo like '%$erpNo$%'
	    		</isNotEmpty>
	    		<isEqual prepend="" property="hasChooseForDiscount" compareValue = "0">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	result.productId IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isEqual prepend="" property="hasChooseForDiscount" compareValue = "1">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	result.productId NOT IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isNotEmpty property="barCode">
	    			AND result.barCode like '%$barCode$%'
	    		</isNotEmpty>
				order by result.gmtCreate desc
				<isNotEmpty property="offset">
	    			LIMIT $offset$, $limit$
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.queryGoodsWithBarCodeCount -->
			 <select id="MS-PRODUCT-QUERY-GOODS-WITH-BAR-CODE-COUNT" resultClass="int">
	        SELECT COUNT(1) FROM
				(
				SELECT
					hqyt_product.ID id,
					hqyt_product.PRODUCT_ID productId,
					hqyt_product.PRODUCT_NAME productName,
					hqyt_product.PRO_NAME proName,
					hqyt_product.PRO_ZJM proZjm,
					hqyt_product.SHOW_OLD showOld,
					hqyt_product.PRODUCT_AREA productArea,
					hqyt_product.SALES sales,
					hqyt_product.MOUNTH_SALES mounthSales,
					hqyt_product.BRAND brand,
					hqyt_product.MANUFACTURER manufacturer,
					hqyt_product.LICENSE_NO licenseNo,
					hqyt_product.TYPE type,
					hqyt_product.FATHER_CATE fatherCate,
					hqyt_product.CHILD_CATE childCate,
					hqyt_product.FATHER_EFECT_CATE fatherEfectCate,
					hqyt_product.CHILD_EFECT_CATE childEfectCate,
					hqyt_product.DEL_FLG delFlg,
					hqyt_product.PRO_TYPE proType,
					hqyt_product.CAN_BUY canBuy,
					hqyt_product.ON_SALE onSale,
					hqyt_product.ERP_NO erpNo,
					hqyt_product.IS_NEW isNew,
					hqyt_product.PICK_TYPE pickType,
					hqyt_product.RANK_NUM rankNum,
					hqyt_product.BUSINESS_CATEGORY businessCategory,
					hqyt_product.FREE_LUAGGER freeLuggage,
					hqyt_product.USER_LEVEL userLevel,
					hqyt_product.GMT_CREATE gmtCreate,
					hqyt_product.GMT_MODIFIED gmtModified,
					hqyt_product_team.TEAM_ID teamId,
					hqyt_team.TEAM_NAME teamName,
					hqyt_team.TEAM_TYPE teamType,
					scu.USERNAME creater,
					smu.USERNAME modifier,
					(SELECT GROUP_CONCAT(BAR_CODE) FROM hqyt_stock_price WHERE GOODS_NO = hqyt_product_team.PRODUCT_ID) barCode
				FROM
					hqyt_product
				LEFT JOIN hqyt_product_team ON hqyt_product_team.PRODUCT_ID = hqyt_product.PRODUCT_ID
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = hqyt_product_team.TEAM_ID
				LEFT JOIN sys_role_user scu ON scu.USER_ID = hqyt_product.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = hqyt_product.MODIFIER
				) result
				WHERE 1=1 
				<isNotEmpty property="productId">
	    			AND result.productId = #productId#
	    		</isNotEmpty>
				<isNotEmpty property="proType">
	    			AND result.proType = #proType#
	    		</isNotEmpty>
				<isNotEmpty property="teamId">
	    			AND result.teamId = #teamId#
	    		</isNotEmpty>
				<isNotEmpty property="productName">
	    			AND result.productName like '%$productName$%'
	    		</isNotEmpty>
				<isNotEmpty property="teamName">
	    			AND result.teamName like '%$teamName$%'
	    		</isNotEmpty>
				<isNotEmpty property="onSale">
	    			AND result.onSale = #onSale#
	    		</isNotEmpty>
				<isNotEmpty property="canBuy">
	    			AND result.canBuy = #canBuy#
	    		</isNotEmpty>
				<isNotEmpty property="licenseNo">
	    			AND result.licenseNo = #licenseNo#
	    		</isNotEmpty>
				<isNotEmpty property="isDelete">
	    			AND result.delFlg = #isDelete#
	    		</isNotEmpty>
	    		<isNotEmpty property="erpNo">
	    			AND result.erpNo like '%$erpNo$%'
	    		</isNotEmpty>
	    		<isEqual prepend="" property="hasChooseForDiscount" compareValue = "0">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	result.productId IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isEqual prepend="" property="hasChooseForDiscount" compareValue = "1">
		        	<isNotEmpty prepend="and" property="linkProIds"> 
					 	result.productId NOT IN
						<iterate property="linkProIds" open="(" close=")" conjunction="," > 
			        		#linkProIds[]# 
			        	</iterate>
		    		</isNotEmpty>
		        </isEqual>
		        <isNotEmpty property="barCode">
	    			AND result.barCode like '%$barCode$%'
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.recoverGood -->
    <update id="MS-PRODUCT-RECOVER-GOOD">
    <![CDATA[
        update hqyt_product set DEL_FLG=#delFlg#, ON_SALE=#onSale#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

</sqlMap>