<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_withdraw -->
    <resultMap id="RM-WITHDRAW" class="com.onway.fyapp.common.dal.dataobject.WithdrawDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="withdrawNo" column="WITHDRAW_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="accountNo" column="ACCOUNT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucherType" column="VOUCHER_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucherNo" column="VOUCHER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="amount.cent" column="AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="huAmount.cent" column="HU_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="rate" column="RATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="status" column="STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="withdrawFrom" column="WITHDRAW_FROM"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="withdrawType" column="WITHDRAW_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="failReason" column="FAIL_REASON"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucehrImg" column="VOUCEHR_IMG"  javaType="java.lang.String" jdbcType="TEXT" />
		<result property="gmtFinish" column="GMT_FINISH"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisWithdrawDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisWithdrawDAO.queryAllUserWithdrawList -->
	<select id="MS-WITHDRAW-QUERY-ALL-USER-WITHDRAW-LIST" resultClass="java.util.HashMap">
	        select 
					hw.*,
					hu.USER_ID,
					hu.OPEN_ID,
					hu.CELL,
					hu.NICK_NAME,
					hu.REAL_NAME,
					scu.USERNAME creater,
					smu.USERNAME modifier,
					al.REAL_NAME al_name,
					al.ALI_ACCOUNT al_account
				from 
				hqyt_withdraw hw 
				left join hqyt_account ha on ha.ACCOUNT_NO = hw.ACCOUNT_NO 
				left join hqyt_user hu on hu.USER_ID = ha.LINK_ID
				left join hqyt_user_ali al on al.LINK_ID = ha.LINK_ID
				LEFT JOIN sys_role_user scu ON scu.USER_ID = hw.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = hw.MODIFIER
				WHERE ha.TYPE = '1'
				<isNotEmpty property="cell" prepend="and">
	    			 hu.CELL like '%$cell$%' 
	    		</isNotEmpty>
	    		<isNotEmpty property="nickName" prepend="and">
	    			 hu.NICK_NAME like '%$nickName$%' 
	    		</isNotEmpty>
	    		<isNotEmpty property="status" prepend="and">
	    			 hw.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="withDrawType" prepend="and">
	    			 hw.WITHDRAW_TYPE = #withDrawType#
	    		</isNotEmpty>
	    		<isNotEmpty prepend="and" property="startDate"> 
					<![CDATA[
						hw.GMT_CREATE >= #startDate#
					]]>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="endDate"> 
					<![CDATA[
						hw.GMT_CREATE < #endDate#
					]]>
				</isNotEmpty>
				<isNotEmpty property="realName" prepend="and">
	    			 hu.REAL_NAME like '%$realName$%' 
	    		</isNotEmpty>
	    		order by hw.GMT_CREATE desc 
	    		<isNotEmpty property="offset">
	    			limit $offset$, $limit$
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisWithdrawDAO.queryAllUserWithdrawListCount -->
			 <select id="MS-WITHDRAW-QUERY-ALL-USER-WITHDRAW-LIST-COUNT" resultClass="int">
	        select 
					COUNT(1)
				from 
				hqyt_withdraw hw 
				left join hqyt_account ha on ha.ACCOUNT_NO = hw.ACCOUNT_NO 
				left join hqyt_user hu on hu.USER_ID = ha.LINK_ID
				WHERE ha.TYPE = '1'
				<isNotEmpty property="cell" prepend="and">
	    			 hu.CELL like '%$cell$%' 
	    		</isNotEmpty>
	    		<isNotEmpty property="nickName" prepend="and">
	    			 hu.NICK_NAME like '%$nickName$%' 
	    		</isNotEmpty>
	    		<isNotEmpty property="status" prepend="and">
	    			 hw.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="withDrawType" prepend="and">
	    			 hw.WITHDRAW_TYPE = #withDrawType#
	    		</isNotEmpty>
	    		<isNotEmpty prepend="and" property="startDate"> 
					<![CDATA[
						hw.GMT_CREATE >= #startDate#
					]]>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="endDate"> 
					<![CDATA[
						hw.GMT_CREATE < #endDate#
					]]>
				</isNotEmpty>
				<isNotEmpty property="realName" prepend="and">
	    			 hu.REAL_NAME like '%$realName$%' 
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisWithdrawDAO.selectWithdrawByIdAndNo -->
			 <select id="MS-WITHDRAW-SELECT-WITHDRAW-BY-ID-AND-NO" resultMap="RM-WITHDRAW">
	        select 
					*
				from 
				hqyt_withdraw 
				where 1=1
				<isNotEmpty property="id" prepend="and">
	    			 ID = #id# 
	    		</isNotEmpty>
	    		<isNotEmpty property="withdrawNo" prepend="and">
	    			 WITHDRAW_NO = #withdrawNo#
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisWithdrawDAO.selectWithdrawByWithdrawNo -->
			 <select id="MS-WITHDRAW-SELECT-WITHDRAW-BY-WITHDRAW-NO" resultMap="RM-WITHDRAW">
	    <![CDATA[
        select * from hqyt_withdraw where (WITHDRAW_NO = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisWithdrawDAO.checkWithdraw -->
    <update id="MS-WITHDRAW-CHECK-WITHDRAW">
    <![CDATA[
        update hqyt_withdraw set STATUS=#status#, FAIL_REASON=#failReason#, MODIFIER=#modifier#, GMT_FINISH=CURRENT_TIMESTAMP, GMT_MODIFIED=CURRENT_TIMESTAMP where ((ID = #id#) AND (WITHDRAW_NO = #withdrawNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisWithdrawDAO.shenhe -->
    <update id="MS-WITHDRAW-SHENHE">
    <![CDATA[
        update hqyt_withdraw set STATUS=#status#, FAIL_REASON=#failReason#, MODIFIER=#modifier#, GMT_FINISH=CURRENT_TIMESTAMP, GMT_MODIFIED=CURRENT_TIMESTAMP where ((ID = #id#) AND (WITHDRAW_NO = #withdrawNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisWithdrawDAO.shenheOnline -->
    <update id="MS-WITHDRAW-SHENHE-ONLINE">
    <![CDATA[
        update hqyt_withdraw set STATUS=#status#, FAIL_REASON=#failReason#, MODIFIER=#modifier#, VOUCEHR_IMG=#voucehrImg#, GMT_FINISH=CURRENT_TIMESTAMP, GMT_MODIFIED=CURRENT_TIMESTAMP where ((ID = #id#) AND (WITHDRAW_NO = #withdrawNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisWithdrawDAO.queryAllTeamWithdrawList -->
	<select id="MS-WITHDRAW-QUERY-ALL-TEAM-WITHDRAW-LIST" resultClass="java.util.HashMap">
	        select 
					hw.*,
					ht.TEAM_ID,
					ht.TEAM_NAME,
					ht.TEAM_TYPE,
					ht.ERP_NO,
					scu.USERNAME creater,
					smu.USERNAME modifier,
					al.REAL_NAME al_name,
					al.ALI_ACCOUNT al_account,
					cu.USER_ID c_userId,
					cu.NICK_NAME c_nickName,
					cu.REAL_NAME c_realName,
					cu.CELL c_cell,
					cu.OPEN_ID c_openId
				from 
					hqyt_withdraw hw 
				left join hqyt_account ha on ha.ACCOUNT_NO = hw.ACCOUNT_NO 
				left join hqyt_team ht on ht.TEAM_ID = ha.LINK_ID
				left join hqyt_user_ali al on al.LINK_ID = ha.LINK_ID
				LEFT JOIN sys_role_user scu ON scu.USER_ID = hw.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = hw.MODIFIER
				left join hqyt_user cu on cu.USER_ID = hw.CREATER
				WHERE ha.TYPE = '2'
	    		<isNotEmpty prepend="and" property="teamName">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamName$%"
				</isNotEmpty>
	    		<isNotEmpty property="teamType" prepend="and">
	    			 ht.TEAM_TYPE = #teamType#
	    		</isNotEmpty>
	    		<isNotEmpty property="status" prepend="and">
	    			 hw.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="withDrawType" prepend="and">
	    			 hw.WITHDRAW_TYPE = #withDrawType#
	    		</isNotEmpty>
	    		<isNotEmpty prepend="and" property="startDate"> 
					<![CDATA[
						hw.GMT_CREATE >= #startDate#
					]]>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="endDate"> 
					<![CDATA[
						hw.GMT_CREATE < #endDate#
					]]>
				</isNotEmpty>
	    		order by hw.GMT_CREATE desc 
	    		<isNotEmpty property="offset">
	    			limit $offset$, $limit$
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisWithdrawDAO.queryAllTeamWithdrawListCount -->
			 <select id="MS-WITHDRAW-QUERY-ALL-TEAM-WITHDRAW-LIST-COUNT" resultClass="int">
	        select 
					COUNT(1)
				from 
				hqyt_withdraw hw 
				left join hqyt_account ha on ha.ACCOUNT_NO = hw.ACCOUNT_NO
				left join hqyt_team ht on ht.TEAM_ID = ha.LINK_ID
				WHERE ha.TYPE = '2'
				<isNotEmpty prepend="and" property="teamName">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamName$%"
				</isNotEmpty>
	    		<isNotEmpty property="teamType" prepend="and">
	    			 ht.TEAM_TYPE = #teamType#
	    		</isNotEmpty>
	    		<isNotEmpty property="status" prepend="and">
	    			 hw.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="withDrawType" prepend="and">
	    			 hw.WITHDRAW_TYPE = #withDrawType#
	    		</isNotEmpty>
	    		<isNotEmpty prepend="and" property="startDate"> 
					<![CDATA[
						hw.GMT_CREATE >= #startDate#
					]]>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="endDate"> 
					<![CDATA[
						hw.GMT_CREATE < #endDate#
					]]>
				</isNotEmpty>
    </select>

</sqlMap>