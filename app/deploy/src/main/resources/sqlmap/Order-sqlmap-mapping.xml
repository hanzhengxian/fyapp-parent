<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_order -->
    <resultMap id="RM-ORDER" class="com.onway.fyapp.common.dal.dataobject.OrderDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT UNSIGNED"  nullValue="0"/>
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderId" column="ORDER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="childOrderId" column="CHILD_ORDER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendId" column="RECOMMEND_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendUserId" column="RECOMMEND_USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendType" column="RECOMMEND_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="realOrderPrice.cent" column="REAL_ORDER_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="orderPrice.cent" column="ORDER_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="childOrderPrice.cent" column="CHILD_ORDER_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="dpriceId" column="DPRICE_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="realPointPrice.cent" column="REAL_POINT_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="pointPrice.cent" column="POINT_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="orderCount" column="ORDER_COUNT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="productPrice.cent" column="PRODUCT_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="productOldPrice.cent" column="PRODUCT_OLD_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="productId" column="PRODUCT_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productName" column="PRODUCT_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="teamId" column="TEAM_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="luggage.cent" column="LUGGAGE"  javaType="long" jdbcType="DECIMAL" />
		<result property="payWay" column="PAY_WAY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="payState" column="PAY_STATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="payNo" column="PAY_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderState" column="ORDER_STATE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="subOrderStatus" column="SUB_ORDER_STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productType" column="PRODUCT_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderDate" column="ORDER_DATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="payDate" column="PAY_DATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="reUserName" column="RE_USER_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="cell" column="CELL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="province" column="PROVINCE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="city" column="CITY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="area" column="AREA"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reAddr" column="RE_ADDR"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="transferType" column="TRANSFER_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="carriCom" column="CARRI_COM"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="carriNo" column="CARRI_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reduceType" column="REDUCE_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reducePoint.cent" column="REDUCE_POINT"  javaType="long" jdbcType="DECIMAL" />
		<result property="reducePointMoney.cent" column="REDUCE_POINT_MONEY"  javaType="long" jdbcType="DECIMAL" />
		<result property="reduceAmount.cent" column="REDUCE_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="reduceAmountPlan.cent" column="REDUCE_AMOUNT_PLAN"  javaType="long" jdbcType="DECIMAL" />
		<result property="reduceAmountTemp.cent" column="REDUCE_AMOUNT_TEMP"  javaType="long" jdbcType="DECIMAL" />
		<result property="reduceAmountVoucher.cent" column="REDUCE_AMOUNT_VOUCHER"  javaType="long" jdbcType="DECIMAL" />
		<result property="invoiceNo" column="INVOICE_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucherNo" column="VOUCHER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucherCode" column="VOUCHER_CODE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sendDate" column="SEND_DATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="completeDate" column="COMPLETE_DATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="reasion" column="REASION"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reasionUser" column="REASION_USER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reasionTime" column="REASION_TIME"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="reasonBans" column="REASON_BANS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reasonBansUser" column="REASON_BANS_USER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reasonBansTime" column="REASON_BANS_TIME"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="stockId" column="STOCK_ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="attrIds" column="ATTR_IDS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="attrNames" column="ATTR_NAMES"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="valueIds" column="VALUE_IDS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="valuees" column="VALUEES"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="imgSrc" column="IMG_SRC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="serviceTimes" column="SERVICE_TIMES"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="reducePlat" column="REDUCE_PLAT"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reducePro" column="REDUCE_PRO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="reduceTeam" column="REDUCE_TEAM"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucher" column="VOUCHER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voucherImg" column="VOUCHER_IMG"  javaType="java.lang.String" jdbcType="TEXT" />
		<result property="dicount" column="DICOUNT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="dicountMoney.cent" column="DICOUNT_MONEY"  javaType="long" jdbcType="DECIMAL" />
		<result property="cashierDiscount" column="CASHIER_DISCOUNT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="cashierUser" column="CASHIER_USER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="pickNo" column="PICK_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="errFlg" column="ERR_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="devoteAmount.cent" column="DEVOTE_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="devoteAmountTo" column="DEVOTE_AMOUNT_TO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkStep" column="CHECK_STEP"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delayFlg" column="DELAY_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delayTime" column="DELAY_TIME"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="thisReturnId" column="THIS_RETURN_ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="voucherFlg" column="VOUCHER_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="printFlg" column="PRINT_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="isSc" column="IS_SC"  javaType="boolean" jdbcType="BIT"  nullValue="false"/>
		<result property="gmtSc" column="GMT_SC"  javaType="java.util.Date" jdbcType="DATETIME" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisOrderDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisOrderDAO.selectByQuery -->
			 <select id="MS-ORDER-SELECT-BY-QUERY" resultClass="java.util.HashMap">
	        SELECT
					o.ID id,
					o.USER_ID userId,
					o.ORDER_ID	orderId,
					o.CHILD_ORDER_ID	childOrderId,
					o.RECOMMEND_ID	recommendId,
					o.REAL_ORDER_PRICE	realOrderPrice,
					o.ORDER_PRICE	orderPrice,
					o.CHILD_ORDER_PRICE	childOrderPrice,
					o.DPRICE_ID	dpriceId,
					o.REAL_POINT_PRICE	realPointPrice,
					o.POINT_PRICE	pointPrice,
					o.ORDER_COUNT	orderCount,
					o.PRODUCT_PRICE	productPrice,
					o.PRODUCT_ID	productId,
					o.PRODUCT_NAME	productName,
					o.TEAM_ID	teamId,
					o.LUGGAGE	luggage,
					o.PAY_WAY	payWay,
					o.PAY_STATE	payState,
					o.PAY_NO	payNo,
					o.ORDER_STATE	orderState,
					o.SUB_ORDER_STATUS subOrderStatus,
					o.PRODUCT_TYPE	productType,
					o.ORDER_DATE	orderDate,
					o.PAY_DATE	payDate,
					o.RE_USER_NAME	reUserName,
					o.CELL	cell,
					o.PROVINCE	province,
					o.CITY	city,
					o.AREA	area,
					o.RE_ADDR	reAddr,
					o.TRANSFER_TYPE	transferType,
					o.CARRI_COM	carriCom,
					o.CARRI_NO	carriNo,
					o.REDUCE_TYPE	reduceType,
					o.REDUCE_AMOUNT	reduceAmount,
					o.REDUCE_AMOUNT_PLAN	reduceAmountPlan,
					o.REDUCE_AMOUNT_TEMP	reduceAmountTemp,
					o.REDUCE_AMOUNT_VOUCHER	reduceAmountVoucher,
					o.INVOICE_NO	invoiceNo,
					o.VOUCHER_NO	voucherNo,
					o.VOUCHER_CODE	voucherCode,
					o.SEND_DATE	sendDate,
					o.COMPLETE_DATE	completeDate,
					o.REASION	reasion,
					o.STOCK_ID	stockId,
					o.ATTR_IDS	attrIds,
					o.ATTR_NAMES	attrNames,
					o.VALUE_IDS	valueIds,
					o.VALUEES	valuees,
					o.IMG_SRC	imgSrc,
					o.SERVICE_TIMES	serviceTimes,
					o.REDUCE_PLAT	reducePlat,
					o.REDUCE_PRO	reducePro,
					o.REDUCE_TEAM	reduceTeam,
					o.VOUCHER	voucher,
					o.VOUCHER_IMG	voucherImg,
					o.DICOUNT	dicount,
					o.CASHIER_DISCOUNT cashierDiscount,
					o.CASHIER_USER	cashierUser,
					o.PICK_NO	pickNo,
					o.MEMO	memo,
					o.GMT_CREATE gmtCreate,
					o.GMT_MODIFIED	gmtModified,
					o.ERR_FLG errFlg,
					o.CHECK_STEP checkStep,
					o.PRODUCT_OLD_PRICE productOldPrice,
					o.REDUCE_POINT reducePoint,
					o.REDUCE_POINT_MONEY reducePointMoney,
					o.DICOUNT_MONEY discountMoney,
					o.DEVOTE_AMOUNT devoteAmount,
					o.DELAY_FLG delayFlg,
					o.DELAY_TIME delayTime,
					o.THIS_RETURN_ID thisReturnId,
					scu.USERNAME creater,
					smu.USERNAME modifier,
					ht.TEAM_NAME teamName,
					sp.ERP_NO erpNo,
					sp.BAR_CODE barCode,
					cu.USER_ID cashierUserId,
					cu.CELL cashierCell,
					cu.REAL_NAME cashierName,
					CASE WHEN o.CASHIER_DISCOUNT <![CDATA[<]]> 1 AND o.CASHIER_DISCOUNT<![CDATA[>]]> 0 THEN '1' ELSE '0' END isCashier
				FROM
					hqyt_order o
				LEFT JOIN sys_role_user scu ON scu.USER_ID = o.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = o.MODIFIER
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = o.TEAM_ID
				LEFT JOIN hqyt_user u ON u.USER_ID = o.USER_ID
				LEFT JOIN hqyt_stock_price sp ON sp.ID = o.STOCK_ID
				LEFT JOIN hqyt_user cu ON cu.USER_ID = o.CASHIER_USER
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = o.PRODUCT_ID
				where 1=1 
				
				<isNotEmpty prepend="and" property="userId"> 
				 	o.USER_ID = #userId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderId"> 
				 	o.ORDER_ID = #orderId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="childOrderId"> 
				 	o.CHILD_ORDER_ID = #childOrderId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productId"> 
				 	o.PRODUCT_ID = #productId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productName"> 
				 	o.PRODUCT_NAME like concat('%',#productName#,'%')
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productErpNo"> 
				 	hp.ERP_NO like concat('%',#productErpNo#,'%')
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderStatusList"> 
				 	o.ORDER_STATE IN
					<iterate property="orderStatusList" open="(" close=")" conjunction="," > 
		        		#orderStatusList[]# 
		        	</iterate>
		    	</isNotEmpty>
				
				<isNotEmpty prepend="and" property="transferType"> 
				 	o.TRANSFER_TYPE = #transferType#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamId"> 
				 	ht.TEAM_ID like '%$teamId$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamName"> 
				 	ht.TEAM_NAME like '%$teamName$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamErpNo"> 
				 	ht.ERP_NO like '%$teamErpNo$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userCell"> 
				 	u.CELL like '%$userCell$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderCell"> 
				 	o.CELL like '%$orderCell$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="payWay"> 
				 	o.PAY_WAY = #payWay#
				</isNotEmpty>
				
	    		<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	o.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                o.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="childOrderIdList"> 
				 	 o.CHILD_ORDER_ID IN
					 <iterate property="childOrderIdList" open="(" close=")" conjunction="," > 
		        		#childOrderIdList[]# 
		        	</iterate>
		    	</isNotEmpty>
		    	
		    	<isNotEmpty prepend="and" property="errFlg"> 
				 	o.ERR_FLG = #errFlg#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="subOrderStatus"> 
				 	o.SUB_ORDER_STATUS IN
					<iterate property="subOrderStatus" open="(" close=")" conjunction="," > 
		        		#subOrderStatus[]# 
		        	</iterate>
		    	</isNotEmpty>
				
				<isNotEmpty prepend="and" property="barCode"> 
				 	sp.BAR_CODE like concat('%',#barCode#,'%')
				</isNotEmpty>
				
				<isEqual prepend="and" property="isCashier" compareValue = "0">
		        	 <![CDATA[
		                (
		                  o.CASHIER_DISCOUNT >= 1
		                OR 
		                  o.CASHIER_DISCOUNT <= 0
		                )
		             ]]> 
		        </isEqual>
		        
		        <isEqual prepend="and" property="isCashier" compareValue = "1">
		        	 <![CDATA[
		                 o.CASHIER_DISCOUNT < 1 AND o.CASHIER_DISCOUNT > 0
		             ]]> 
		        </isEqual>
		        
		        <isNotEmpty prepend="and" property="cashierUser"> 
				 	( 
				 	  cu.USER_ID  like '%$cashierUser$%'
				 	OR
				 	  cu.CELL  like '%$cashierUser$%'
				 	OR
				 	  cu.REAL_NAME  like '%$cashierUser$%'
				 	)
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="voucher"> 
				 	o.VOUCHER = #voucher#
				</isNotEmpty>
		    	
		    	<isEqual prepend="" property="rankType" compareValue = "0">
		        	order by o.GMT_CREATE DESC 
		        </isEqual>
		        
		        <isEqual prepend="" property="rankType" compareValue = "1">
		        	order by o.RE_USER_NAME DESC, o.PROVINCE DESC, o.CITY DESC, o.AREA DESC, o.RE_ADDR DESC, o.ORDER_ID DESC 
		        </isEqual>
	    		
	    		<isNotEmpty property="offset"> 
				 	LIMIT $offset$, $limit$
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectCountByQuery -->
			 <select id="MS-ORDER-SELECT-COUNT-BY-QUERY" resultClass="int">
	        SELECT 
					count(1)
				FROM
					hqyt_order o
				LEFT JOIN sys_role_user scu ON scu.USER_ID = o.CREATER
				LEFT JOIN sys_role_user smu ON smu.USER_ID = o.MODIFIER
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = o.TEAM_ID
				LEFT JOIN hqyt_user u ON u.USER_ID = o.USER_ID
				LEFT JOIN hqyt_stock_price sp ON sp.ID = o.STOCK_ID
				LEFT JOIN hqyt_user cu ON cu.USER_ID = o.CASHIER_USER
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = o.PRODUCT_ID
				where 1=1 
				
				<isNotEmpty prepend="and" property="userId"> 
				 	o.USER_ID = #userId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderId"> 
				 	o.ORDER_ID = #orderId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="childOrderId"> 
				 	o.CHILD_ORDER_ID = #childOrderId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productId"> 
				 	o.PRODUCT_ID = #productId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productName"> 
				 	o.PRODUCT_NAME like concat('%',#productName#,'%')
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productErpNo"> 
				 	hp.ERP_NO like concat('%',#productErpNo#,'%')
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderStatusList"> 
				 	ORDER_STATE IN
					<iterate property="orderStatusList" open="(" close=")" conjunction="," > 
		        		#orderStatusList[]# 
		        	</iterate>
		    	</isNotEmpty>
				
				<isNotEmpty prepend="and" property="transferType"> 
				 	o.TRANSFER_TYPE = #transferType#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamId"> 
				 	ht.TEAM_ID like '%$teamId$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamName"> 
				 	ht.TEAM_NAME like '%$teamName$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamErpNo"> 
				 	ht.ERP_NO like '%$teamErpNo$%'
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="userCell"> 
				 	u.CELL like '%$userCell$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderCell"> 
				 	o.CELL like '%$orderCell$%'
				</isNotEmpty>
				<isNotEmpty prepend="and" property="payWay"> 
				 	o.PAY_WAY = #payWay#
				</isNotEmpty>
				
	    		<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	o.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                o.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="childOrderIdList"> 
				 	 o.CHILD_ORDER_ID IN
					 <iterate property="childOrderIdList" open="(" close=")" conjunction="," > 
		        		#childOrderIdList[]# 
		        	</iterate>
		    	</isNotEmpty>
		    	
		    	<isNotEmpty prepend="and" property="errFlg"> 
				 	o.ERR_FLG = #errFlg#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="subOrderStatus"> 
				 	o.SUB_ORDER_STATUS IN
					<iterate property="subOrderStatus" open="(" close=")" conjunction="," > 
		        		#subOrderStatus[]# 
		        	</iterate>
		    	</isNotEmpty>
				
				<isNotEmpty prepend="and" property="barCode"> 
				 	sp.BAR_CODE like concat('%',#barCode#,'%')
				</isNotEmpty>
				
				<isEqual prepend="and" property="isCashier" compareValue = "0">
		        	 <![CDATA[
		                (
		                  o.CASHIER_DISCOUNT >= 1
		                OR 
		                  o.CASHIER_DISCOUNT <= 0
		                )
		             ]]> 
		        </isEqual>
		        
		        <isEqual prepend="and" property="isCashier" compareValue = "1">
		        	 <![CDATA[
		                 o.CASHIER_DISCOUNT < 1 AND o.CASHIER_DISCOUNT > 0
		             ]]> 
		        </isEqual>
		        
		        <isNotEmpty prepend="and" property="cashierUser"> 
				 	( 
				 	  cu.USER_ID  like '%$cashierUser$%'
				 	OR
				 	  cu.CELL  like '%$cashierUser$%'
				 	OR
				 	  cu.REAL_NAME  like '%$cashierUser$%'
				 	)
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="voucher"> 
				 	o.VOUCHER = #voucher#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectByChildOrderId -->
			 <select id="MS-ORDER-SELECT-BY-CHILD-ORDER-ID" resultMap="RM-ORDER">
	    <![CDATA[
        select * from hqyt_order where (CHILD_ORDER_ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateWuliuAndSta -->
    <update id="MS-ORDER-UPDATE-WULIU-AND-STA">
    <![CDATA[
        update hqyt_order set CARRI_COM=#carriCom#, CARRI_NO=#carriNo#, ORDER_STATE='2', MODIFIER=#modifier#, SEND_DATE=CURRENT_TIMESTAMP, GMT_MODIFIED=CURRENT_TIMESTAMP where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.updateOrderStatByChildId -->
    <update id="MS-ORDER-UPDATE-ORDER-STAT-BY-CHILD-ID">
    <![CDATA[
        update hqyt_order set ORDER_STATE=#orderState#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.queryAutoReceiveOrder -->
			 <select id="MS-ORDER-QUERY-AUTO-RECEIVE-ORDER" resultMap="RM-ORDER">
	        SELECT 
	        		*
	        	FROM 
	        	hqyt_order
	            WHERE
	            	1=1
            	<isNotEmpty property="dayAgo" prepend="and">
	                <![CDATA[
						#dayAgo# > GMT_MODIFIED
					]]>
	        	</isNotEmpty>
	        	<isNotEmpty property="oldOrderStatus" prepend="and">
	               	ORDER_STATE = #oldOrderStatus#
	        	</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectByQueryNotMap -->
			 <select id="MS-ORDER-SELECT-BY-QUERY-NOT-MAP" resultMap="RM-ORDER">
	        SELECT
					*
				FROM
					hqyt_order 
				where 1=1 
				
				<isNotEmpty prepend="and" property="userId"> 
				 	USER_ID = #userId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderId"> 
				 	ORDER_ID = #orderId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="productId"> 
				 	PRODUCT_ID = #productId#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="orderState"> 
				 	ORDER_STATE = #orderState#
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="transferType"> 
				 	TRANSFER_TYPE = #transferType#
				</isNotEmpty>
	    		
	    		order by GMT_CREATE desc
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateOrderStatByChildIdList -->
    <update id="MS-ORDER-UPDATE-ORDER-STAT-BY-CHILD-ID-LIST">
        update hqyt_order
				set 
				  ORDER_STATE = #orderStatus#,
				  MODIFIER = #modifier#,
				  GMT_MODIFIED = CURRENT_TIMESTAMP
			    where
			     <isNotEmpty prepend="" property="childOrderIdList"> 
				 	 CHILD_ORDER_ID IN
					 <iterate property="childOrderIdList" open="(" close=")" conjunction="," > 
		        		#childOrderIdList[]# 
		        	</iterate>
		    	 </isNotEmpty>
    </update>

    <!-- mapped statement for IbatisOrderDAO.queryForOrderReturnNotSucc -->
			 <select id="MS-ORDER-QUERY-FOR-ORDER-RETURN-NOT-SUCC" resultClass="java.util.HashMap">
	        SELECT
					o.ID id,
					o.USER_ID userId,
					o.ORDER_ID	orderId,
					o.CHILD_ORDER_ID	childOrderId,
					o.RECOMMEND_ID	recommendId,
					o.REAL_ORDER_PRICE	realOrderPrice,
					o.ORDER_PRICE	orderPrice,
					o.CHILD_ORDER_PRICE	childOrderPrice,
					o.DPRICE_ID	dpriceId,
					o.REAL_POINT_PRICE	realPointPrice,
					o.POINT_PRICE	pointPrice,
					o.ORDER_COUNT	orderCount,
					o.PRODUCT_PRICE	productPrice,
					o.PRODUCT_ID	productId,
					o.PRODUCT_NAME	productName,
					o.TEAM_ID	teamId,
					o.LUGGAGE	luggage,
					o.PAY_WAY	payWay,
					o.PAY_STATE	payState,
					o.PAY_NO	payNo,
					o.ORDER_STATE	orderState,
					o.SUB_ORDER_STATUS subOrderStatus,
					o.PRODUCT_TYPE	productType,
					o.ORDER_DATE	orderDate,
					o.PAY_DATE	payDate,
					o.RE_USER_NAME	reUserName,
					o.CELL	cell,
					o.PROVINCE	province,
					o.CITY	city,
					o.AREA	area,
					o.RE_ADDR	reAddr,
					o.TRANSFER_TYPE	transferType,
					o.CARRI_COM	carriCom,
					o.CARRI_NO	carriNo,
					o.REDUCE_TYPE	reduceType,
					o.REDUCE_AMOUNT	reduceAmount,
					o.REDUCE_AMOUNT_PLAN	reduceAmountPlan,
					o.REDUCE_AMOUNT_TEMP	reduceAmountTemp,
					o.REDUCE_AMOUNT_VOUCHER	reduceAmountVoucher,
					o.INVOICE_NO	invoiceNo,
					o.VOUCHER_NO	voucherNo,
					o.VOUCHER_CODE	voucherCode,
					o.SEND_DATE	sendDate,
					o.COMPLETE_DATE	completeDate,
					o.REASION	reasion,
					o.STOCK_ID	stockId,
					o.ATTR_IDS	attrIds,
					o.ATTR_NAMES	attrNames,
					o.VALUE_IDS	valueIds,
					o.VALUEES	valuees,
					o.IMG_SRC	imgSrc,
					o.SERVICE_TIMES	serviceTimes,
					o.REDUCE_PLAT	reducePlat,
					o.REDUCE_PRO	reducePro,
					o.REDUCE_TEAM	reduceTeam,
					o.VOUCHER	voucher,
					o.VOUCHER_IMG	voucherImg,
					o.DICOUNT	dicount,
					o.CASHIER_DISCOUNT cashierDiscount,
					o.CASHIER_USER	cashierUser,
					o.PICK_NO	pickNo,
					o.MEMO	memo,
					o.GMT_CREATE gmtCreate,
					o.GMT_MODIFIED	gmtModified,
					o.ERR_FLG errFlg,
					o.CHECK_STEP checkStep,
					o.PRODUCT_OLD_PRICE productOldPrice,
					o.REDUCE_POINT reducePoint,
					o.REDUCE_POINT_MONEY reducePointMoney,
					o.DICOUNT_MONEY discountMoney,
					o.DEVOTE_AMOUNT devoteAmount,
					o.DELAY_FLG delayFlg,
					o.DELAY_TIME delayTime,
					o.THIS_RETURN_ID thisReturnId,
					r.CARRI_COM carriCom,
					r.CARRI_NO carriNo,
					r.REASON reason,
					r.REASON_OTHER resonOther,
					r.RETURN_IMG retunImg,
					r.MONEY_STATUS moneyStatus,
					r.MONEY_MEMO moneyMemo
				FROM
					hqyt_order o
				LEFT JOIN hqyt_order_return r ON r.CHILD_ORDER_ID = o.CHILD_ORDER_ID
				WHERE 1=1 
				<isNotEmpty prepend="and" property="childOrderId"> 
				 	o.CHILD_ORDER_ID = #childOrderId#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="moneyStatus"> 
				 	r.MONEY_STATUS = #moneyStatus#
				</isNotEmpty>
		        order by o.GMT_CREATE DESC
	    		<isNotEmpty property="offset"> 
				 	LIMIT $offset$, $limit$
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryForOrderReturnNotSuccCount -->
			 <select id="MS-ORDER-QUERY-FOR-ORDER-RETURN-NOT-SUCC-COUNT" resultClass="int">
	        SELECT
					COUNT(1)
				FROM
					hqyt_order o
				LEFT JOIN hqyt_order_return r ON r.CHILD_ORDER_ID = o.CHILD_ORDER_ID
				WHERE 1=1 
				<isNotEmpty prepend="and" property="childOrderId"> 
				 	o.CHILD_ORDER_ID = #childOrderId#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="moneyStatus"> 
				 	r.MONEY_STATUS = #moneyStatus#
				</isNotEmpty>
		        order by o.GMT_CREATE DESC
	    		<isNotEmpty property="offset"> 
				 	LIMIT $offset$, $limit$
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateOrderStatusToNotSendIngByChildIdList -->
    <update id="MS-ORDER-UPDATE-ORDER-STATUS-TO-NOT-SEND-ING-BY-CHILD-ID-LIST">
        update hqyt_order
				set 
				  ORDER_STATE = #orderStatus#
			    where
			     <isNotEmpty prepend="" property="childOrderIdList"> 
				 	 CHILD_ORDER_ID IN
					 <iterate property="childOrderIdList" open="(" close=")" conjunction="," > 
		        		#childOrderIdList[]# 
		        	</iterate>
		    	 </isNotEmpty>
    </update>

    <!-- mapped statement for IbatisOrderDAO.modifyDelayFlg -->
    <update id="MS-ORDER-MODIFY-DELAY-FLG">
    <![CDATA[
        update hqyt_order set DELAY_FLG=#delayFlg#, DELAY_TIME=CURRENT_TIMESTAMP where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.modifyPrintFlg -->
    <update id="MS-ORDER-MODIFY-PRINT-FLG">
    <![CDATA[
        update hqyt_order set PRINT_FLG=#printFlg# where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.modifyMailno -->
    <update id="MS-ORDER-MODIFY-MAILNO">
    <![CDATA[
        update hqyt_order set CARRI_COM=#carriCom#, CARRI_NO=#carriNo#, MODIFIER=#modifier# where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.queryByMailno -->
			 <select id="MS-ORDER-QUERY-BY-MAILNO" resultMap="RM-ORDER">
	        SELECT 
	        		*
	        	FROM 
	        	hqyt_order
	            WHERE
	            	1=1
	        	<isNotEmpty property="mailno" prepend="and">
	               	CARRI_NO = #mailno#
	        	</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.modifyOrderStatus -->
    <update id="MS-ORDER-MODIFY-ORDER-STATUS">
    <![CDATA[
        update hqyt_order set ORDER_STATE=#orderState#, MODIFIER=#modifier# where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.modifyDevoteByChildOrderId -->
    <update id="MS-ORDER-MODIFY-DEVOTE-BY-CHILD-ORDER-ID">
    <![CDATA[
        update hqyt_order set DEVOTE_AMOUNT=#devoteAmount.cent# where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.changeRecommendType -->
    <update id="MS-ORDER-CHANGE-RECOMMEND-TYPE">
    <![CDATA[
        update hqyt_order set RECOMMEND_TYPE=#recommendType#, RECOMMEND_ID=#recommendId#, RECOMMEND_USER_ID=#recommendUserId# where (CHILD_ORDER_ID = #childOrderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.queryAllSaleCheckList -->
			 <select id="MS-ORDER-QUERY-ALL-SALE-CHECK-LIST" resultClass="java.util.HashMap">
	        SELECT
					<!-- 业务经理 -->
					ywer.USER_ID yw_userId,
					ywer.CELL yw_cell,
					IFNULL(ywer.REAL_NAME, ywer.NICK_NAME) yw_name,
					ho.REASION yw_reason,
					ho.REASION_TIME yw_time,
					<!-- 大区经理 -->
					dqer.USER_ID dq_userId,
					dqer.CELL dq_cell,
					IFNULL(dqer.REAL_NAME, dqer.NICK_NAME) dq_name,
					ho.REASON_BANS dq_reason,
					ho.REASON_BANS_TIME dq_time,
					<!-- 操作人经理 -->
					oper.USER_ID op_userId,
					oper.CELL op_cell,
					IFNULL(oper.REAL_NAME, oper.NICK_NAME) op_name,
					ho.GMT_CREATE gmtCreate,
					ho.CASHIER_DISCOUNT cashierDiscount,
					<!-- 购买人信息 -->
					ou.USER_ID buy_userId,
					ou.CELL buy_cell,
					IFNULL(ou.REAL_NAME, ou.NICK_NAME) buy_name,
					ho.ORDER_COUNT orderCount,
					ho.PRODUCT_PRICE productPrice,
					ho.PRODUCT_OLD_PRICE productOldPrice,
					ho.REAL_ORDER_PRICE realOrderPrice,
					ho.ORDER_PRICE orderPrice,
					ht.TEAM_NAME teamName,
					ho.ORDER_ID orderNo,
					ho.CHILD_ORDER_ID orderId,
					ho.PRODUCT_ID productId,
					hp.ERP_NO proErpNo,
					ho.PRODUCT_NAME productName,
					ho.REDUCE_PLAT	reducePlat,
					ho.REDUCE_PRO	reducePro,
					ho.REDUCE_TEAM	reduceTeam,
					hp.RANK_NUM proNum
				FROM hqyt_order ho
				LEFT JOIN hqyt_user ywer ON ywer.USER_ID = ho.REASION_USER 
				LEFT JOIN hqyt_user dqer ON dqer.USER_ID = ho.REASON_BANS_USER 
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        and 
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT > 0
		            ]]>    
		        and
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT < 1
		            ]]>   
		        and REASION_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="province">
					ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
					ht.CITY like "%$city$%"
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="operMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.REAL_NAME) like "%$operMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="ywerMsg">
					CONCAT_WS(&apos; &apos;,ywer.USER_ID,ywer.CELL,ywer.REAL_NAME) like "%$ywerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="dqerMsg">
					CONCAT_WS(&apos; &apos;,dqer.USER_ID,dqer.CELL,dqer.REAL_NAME) like "%$dqerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDateYw" prepend="and">
		            <![CDATA[
		             	ho.REASION_TIME >=  #startDateYw#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateYw" prepend="and">
		             <![CDATA[
		                ho.REASION_TIME <= #endDateYw#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateDq" prepend="and">
		            <![CDATA[
		             	ho.REASON_BANS_TIME >=  #startDateDq#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateDq" prepend="and">
		             <![CDATA[
		                ho.REASON_BANS_TIME <= #endDateDq#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateOrder" prepend="and">
		            <![CDATA[
		             	ho.GMT_CREATE >=  #startDateOrder#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateOrder" prepend="and">
		             <![CDATA[
		                ho.GMT_CREATE <= #endDateOrder#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				
				<!-- 业务审核通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "0">
						( 
							ho.ORDER_STATE NOT IN ('13','14') OR 
							(
								ho.ORDER_STATE = '13' AND ho.SUB_ORDER_STATUS = '13.2'
							)
					 	)
				</isEqual>
				<!-- 业务审核不通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.1'
				</isEqual>
				
				<!-- 大区审核通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "0">
						ho.ORDER_STATE NOT IN ('13','14')
				</isEqual>
				<!-- 大区审核不通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.2'
				</isEqual>
		        
				ORDER BY ho.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllSaleCheckListCount -->
			 <select id="MS-ORDER-QUERY-ALL-SALE-CHECK-LIST-COUNT" resultClass="int">
	        SELECT
					COUNT(1)
				FROM hqyt_order ho
				LEFT JOIN hqyt_user ywer ON ywer.USER_ID = ho.REASION_USER 
				LEFT JOIN hqyt_user dqer ON dqer.USER_ID = ho.REASON_BANS_USER 
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        and 
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT > 0
		            ]]>    
		        and
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT < 1
		            ]]>   
		        and REASION_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="province">
					ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
					ht.CITY like "%$city$%"
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="operMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.REAL_NAME) like "%$operMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="ywerMsg">
					CONCAT_WS(&apos; &apos;,ywer.USER_ID,ywer.CELL,ywer.REAL_NAME) like "%$ywerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="dqerMsg">
					CONCAT_WS(&apos; &apos;,dqer.USER_ID,dqer.CELL,dqer.REAL_NAME) like "%$dqerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDateYw" prepend="and">
		            <![CDATA[
		             	ho.REASION_TIME >=  #startDateYw#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateYw" prepend="and">
		             <![CDATA[
		                ho.REASION_TIME <= #endDateYw#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateDq" prepend="and">
		            <![CDATA[
		             	ho.REASON_BANS_TIME >=  #startDateDq#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateDq" prepend="and">
		             <![CDATA[
		                ho.REASON_BANS_TIME <= #endDateDq#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateOrder" prepend="and">
		            <![CDATA[
		             	ho.GMT_CREATE >=  #startDateOrder#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateOrder" prepend="and">
		             <![CDATA[
		                ho.GMT_CREATE <= #endDateOrder#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				 <isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				
				<!-- 业务审核通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "0">
						( 
							ho.ORDER_STATE NOT IN ('13','14') OR 
							(
								ho.ORDER_STATE = '13' AND ho.SUB_ORDER_STATUS = '13.2'
							)
					 	)
				</isEqual>
				<!-- 业务审核不通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.1'
				</isEqual>
				
				<!-- 大区审核通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "0">
						ho.ORDER_STATE NOT IN ('13','14')
				</isEqual>
				<!-- 大区审核不通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.2'
				</isEqual>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllDiscountUseList -->
			 <select id="MS-ORDER-QUERY-ALL-DISCOUNT-USE-LIST" resultClass="java.util.HashMap">
	        SELECT
					result4.ORDER_ID orderNo,
					result4.CHILD_ORDER_ID orderId,
					hqyt_user.CELL userCell,
					result4.PRODUCT_NAME proName,
					hqyt_discount.DISCOUNT_ID discountId,
					hqyt_discount.DISCOUNT_NAME discountName,
					hqyt_team.TEAM_ID teamId,
					hqyt_team.TEAM_NAME teamName,
					hqyt_team.ERP_NO teamErpNo,
					hqyt_team.ADDRESS teamAddress,
					hqyt_team.CITY teamCity,
					result4.ORDER_PRICE orderPrice,
					IFNULL(result4.amount,0) amount,
					result4.GMT_CREATE gmtCreate
				FROM
					(
						SELECT
							result3.*, substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) discountId,
							substring_index(
								substring_index(
									result3.replaceJsonA,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) amount
						FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
					) result4
				LEFT JOIN hqyt_discount ON hqyt_discount.DISCOUNT_ID = result4.discountId
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result4.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result4.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- <isNotEmpty prepend="and" property="province">
					hqyt_team.ADDRESS like concat('%',#province#,'%')
				</isNotEmpty> -->
				<!-- <isNotEmpty prepend="and" property="city">
					hqyt_team.CITY like concat('%',#city#,'%')
				</isNotEmpty> -->
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountName">
					hqyt_discount.DISCOUNT_NAME like concat('%',#discountName#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					hqyt_discount.DISCOUNT_ID like concat('%',#discountId#,'%')
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result4.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result4.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
				ORDER BY result4.GMT_CREATE DESC
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllDiscountUseListCount -->
			 <select id="MS-ORDER-QUERY-ALL-DISCOUNT-USE-LIST-COUNT" resultClass="int">
	        SELECT
					COUNT(1)
				FROM
					(
						SELECT
							result3.*, substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) discountId,
							substring_index(
								substring_index(
									result3.replaceJsonA,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) amount
						FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
					) result4
				LEFT JOIN hqyt_discount ON hqyt_discount.DISCOUNT_ID = result4.discountId
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result4.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result4.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- <isNotEmpty prepend="and" property="province">
					hqyt_team.ADDRESS like concat('%',#province#,'%')
				</isNotEmpty> -->
				<!-- <isNotEmpty prepend="and" property="city">
					hqyt_team.CITY like concat('%',#city#,'%')
				</isNotEmpty> -->
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountName">
					hqyt_discount.DISCOUNT_NAME like concat('%',#discountName#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					hqyt_discount.DISCOUNT_ID like concat('%',#discountId#,'%')
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result4.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result4.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.sumAllDiscountUseList -->
			 <select id="MS-ORDER-SUM-ALL-DISCOUNT-USE-LIST" resultClass="java.util.HashMap">
	        SELECT
					SUM(result4.ORDER_PRICE) orderPrice,
					SUM(IFNULL(result4.amount,0)) amount
				FROM
					(
						SELECT
							result3.*, substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) discountId,
							substring_index(
								substring_index(
									result3.replaceJsonA,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) amount
						FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
					) result4
				LEFT JOIN hqyt_discount ON hqyt_discount.DISCOUNT_ID = result4.discountId
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result4.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result4.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- <isNotEmpty prepend="and" property="province">
					hqyt_team.ADDRESS like concat('%',#province#,'%')
				</isNotEmpty> -->
				<!-- <isNotEmpty prepend="and" property="city">
					hqyt_team.CITY like concat('%',#city#,'%')
				</isNotEmpty> -->
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountName">
					hqyt_discount.DISCOUNT_NAME like concat('%',#discountName#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					hqyt_discount.DISCOUNT_ID like concat('%',#discountId#,'%')
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result4.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result4.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesAmount -->
			 <select id="MS-ORDER-CALCULATE-SALES-AMOUNT" resultClass="java.util.HashMap">
	        SELECT 
							SUM(rs.realPriceA) realPriceA,SUM(rs.realPriceB) realPriceB
						FROM
						(
							SELECT
								IFNULL(SUM(REAL_ORDER_PRICE+REDUCE_AMOUNT_VOUCHER), 0) realPriceA,
								0 realPriceB
							FROM
								hqyt_order
							WHERE 1 = 1
							<isNotEmpty prepend="and" property="teamIds"> 
							 	TEAM_ID IN
								<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        		#teamIds[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="orderStatus"> 
							 	ORDER_STATE IN
								<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        		#orderStatus[]# 
					        	</iterate>
					    	</isNotEmpty>
							
							<isNotEmpty property="startDate" prepend="and">
					             <![CDATA[
					                GMT_CREATE >= #startDate#
					             ]]>      
					        </isNotEmpty>
					        <isNotEmpty property="endDate" prepend="and">
					             <![CDATA[
					                GMT_CREATE < #endDate#
					             ]]>      
					        </isNotEmpty>
					        
							UNION
							
							SELECT
								0 realPriceA,
								IFNULL(SUM(REAL_ORDER_PRICE+REDUCE_AMOUNT_VOUCHER), 0) realPriceB
							FROM
								hqyt_order
							WHERE 1 = 1
							<isNotEmpty prepend="and" property="teamIds"> 
							 	TEAM_ID IN
								<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        		#teamIds[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="orderStatus"> 
							 	ORDER_STATE IN
								<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        		#orderStatus[]# 
					        	</iterate>
					    	</isNotEmpty>
							
							<isNotEmpty property="startDates" prepend="and">
					             <![CDATA[
					                GMT_CREATE >= #startDates#
					             ]]>      
					        </isNotEmpty>
					        <isNotEmpty property="endDates" prepend="and">
					             <![CDATA[
					                GMT_CREATE < #endDates#
					             ]]>      
					        </isNotEmpty>
						) rs
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesAmountCategory -->
			 <select id="MS-ORDER-CALCULATE-SALES-AMOUNT-CATEGORY" resultClass="java.util.HashMap">
	        SELECT
					result.realPriceA realPriceA,
					result.realPriceB realPriceB,
					result.saleNumA saleNumA,
					result.saleNumB saleNumB
				FROM
					(
						SELECT 
							SUM(rs.realPriceA) realPriceA,
							SUM(rs.realPriceB) realPriceB,
							SUM(rs.saleNumA) saleNumA,
							SUM(rs.saleNumB) saleNumB
						FROM
						(
							SELECT
								IFNULL(SUM(hqyt_order.REAL_ORDER_PRICE+hqyt_order.REDUCE_AMOUNT_VOUCHER), 0) realPriceA,
								IFNULL(SUM(hqyt_order.ORDER_COUNT), 0) saleNumA,
								0 realPriceB,
								0 saleNumB
							FROM
								hqyt_order
							LEFT JOIN hqyt_team ON hqyt_order.TEAM_ID = hqyt_team.TEAM_ID
							LEFT JOIN hqyt_product ON hqyt_product.PRODUCT_ID = hqyt_order.PRODUCT_ID
							WHERE 1 = 1
							<isNotEmpty prepend="and" property="proMsg">
								CONCAT_WS(&apos; &apos;,hqyt_product.PRODUCT_ID,hqyt_product.ERP_NO,hqyt_product.PRODUCT_NAME,hqyt_product.PRO_NAME) like "%$proMsg$%"
							</isNotEmpty>
							<isNotEmpty prepend="and" property="province">
								hqyt_team.ADDRESS like "%$province$%"
							</isNotEmpty>
							<isNotEmpty prepend="and" property="city">
								hqyt_team.CITY like "%$city$%"
							</isNotEmpty>
							<isNotEmpty prepend="and" property="childCategoryS"> 
									hqyt_order.PRODUCT_ID IN (
											select DISTINCT PRODUCT_ID from 
												hqyt_product_category
											where CATEGORY_ID in 
									<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
								        	#childCategoryS[]# 
								    </iterate>
									)
							</isNotEmpty>
					    	<isNotEmpty prepend="and" property="teamId"> 
							 	hqyt_team.TEAM_ID IN
								<iterate property="teamId" open="(" close=")" conjunction="," > 
					        		#teamId[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="teamLevel"> 
							 	hqyt_team.TEAM_LEVEL IN
								<iterate property="teamLevel" open="(" close=")" conjunction="," > 
					        		#teamLevel[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="orderStatus"> 
							 	hqyt_order.ORDER_STATE IN
								<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        		#orderStatus[]# 
					        	</iterate>
					    	</isNotEmpty>
							
							<isNotEmpty property="startDate" prepend="and">
					             <![CDATA[
					                hqyt_order.GMT_CREATE >= #startDate#
					             ]]>      
					        </isNotEmpty>
					        <isNotEmpty property="endDate" prepend="and">
					             <![CDATA[
					                hqyt_order.GMT_CREATE < #endDate#
					             ]]>      
					        </isNotEmpty>
					        
							UNION
							
							SELECT
								0 realPriceA,
								0 saleNumA,
								IFNULL(SUM(hqyt_order.REAL_ORDER_PRICE+hqyt_order.REDUCE_AMOUNT_VOUCHER), 0) realPriceB,
								IFNULL(SUM(hqyt_order.ORDER_COUNT), 0) saleNumB
						    FROM
								hqyt_order
							LEFT JOIN hqyt_team ON hqyt_order.TEAM_ID = hqyt_team.TEAM_ID
							LEFT JOIN hqyt_product ON hqyt_product.PRODUCT_ID = hqyt_order.PRODUCT_ID
							WHERE 1 = 1
							<isNotEmpty prepend="and" property="proMsg">
								CONCAT_WS(&apos; &apos;,hqyt_product.PRODUCT_ID,hqyt_product.ERP_NO,hqyt_product.PRODUCT_NAME,hqyt_product.PRO_NAME) like "%$proMsg$%"
							</isNotEmpty>
							<isNotEmpty prepend="and" property="province">
								hqyt_team.ADDRESS like "%$province$%"
							</isNotEmpty>
							<isNotEmpty prepend="and" property="city">
								hqyt_team.CITY like "%$city$%"
							</isNotEmpty>
							
							<isNotEmpty prepend="and" property="childCategoryS"> 
									hqyt_order.PRODUCT_ID IN (
											select DISTINCT PRODUCT_ID from 
												hqyt_product_category
											where CATEGORY_ID in 
									<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
								        	#childCategoryS[]# 
								    </iterate>
									)
							</isNotEmpty>
					    	<isNotEmpty prepend="and" property="teamId"> 
							 	hqyt_team.TEAM_ID IN
								<iterate property="teamId" open="(" close=")" conjunction="," > 
					        		#teamId[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="teamLevel"> 
							 	hqyt_team.TEAM_LEVEL IN
								<iterate property="teamLevel" open="(" close=")" conjunction="," > 
					        		#teamLevel[]# 
					        	</iterate>
					    	</isNotEmpty>
					    	<isNotEmpty prepend="and" property="orderStatus"> 
							 	hqyt_order.ORDER_STATE IN
								<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        		#orderStatus[]# 
					        	</iterate>
					    	</isNotEmpty>
							
							<isNotEmpty property="startDates" prepend="and">
					             <![CDATA[
					                hqyt_order.GMT_CREATE >= #startDates#
					             ]]>      
					        </isNotEmpty>
					        <isNotEmpty property="endDates" prepend="and">
					             <![CDATA[
					                hqyt_order.GMT_CREATE < #endDates#
					             ]]>      
					        </isNotEmpty>
						) rs
				)result
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesStoreDiscountRate -->
			 <select id="MS-ORDER-CALCULATE-SALES-STORE-DISCOUNT-RATE" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(REAL_ORDER_PRICE+REDUCE_AMOUNT_VOUCHER), 0) realPayPrice,
					IFNULL(SUM(ORDER_PRICE),0) oldPayPrice
				FROM
					hqyt_order
				WHERE 1 = 1
				<isNotEmpty prepend="and" property="teamIds"> 
					TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						     #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
					ORDER_STATE IN
					<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					         #orderStatus[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesStoreDiscountRateForOrderId -->
			 <select id="MS-ORDER-CALCULATE-SALES-STORE-DISCOUNT-RATE-FOR-ORDER-ID" resultClass="java.util.HashMap">
	        SELECT
					CHILD_ORDER_ID childOrderId,
					REDUCE_PRO reducePro,
					REDUCE_TEAM reduceTeam,
					REDUCE_PLAT reducePlat
				FROM
					hqyt_order
				WHERE 1 = 1
				<isNotEmpty prepend="and" property="teamIds"> 
					TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						     #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
					ORDER_STATE IN
					<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					         #orderStatus[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryDiscountRate -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-DISCOUNT-RATE" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(hqyt_order.REAL_ORDER_PRICE+hqyt_order.REDUCE_AMOUNT_VOUCHER), 0) realPayPrice,
					IFNULL(SUM(hqyt_order.ORDER_PRICE),0) oldPayPrice
				FROM
					hqyt_order
				WHERE 1 = 1
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,hqyt_product.PRODUCT_ID,hqyt_product.PRODUCT_NAME,hqyt_product.PRO_ZJM,hqyt_product.PRO_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="childCategoryS"> 
						hqyt_order.PRODUCT_ID IN (
								select DISTINCT PRODUCT_ID from 
									hqyt_product_category
								where CATEGORY_ID in 
						<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
					        	#childCategoryS[]# 
					    </iterate>
						)
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamIds"> 
						hqyt_order.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						hqyt_order.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       hqyt_order.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       hqyt_order.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryDiscountRateForOrderId -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-DISCOUNT-RATE-FOR-ORDER-ID" resultClass="java.util.HashMap">
	        SELECT
					CHILD_ORDER_ID childOrderId,
					REDUCE_PRO reducePro,
					REDUCE_TEAM reduceTeam,
					REDUCE_PLAT reducePlat
				FROM
					hqyt_order
				WHERE 1 = 1
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,hqyt_product.PRODUCT_ID,hqyt_product.PRODUCT_NAME,hqyt_product.PRO_ZJM,hqyt_product.PRO_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="childCategoryS"> 
						hqyt_order.PRODUCT_ID IN (
								select DISTINCT PRODUCT_ID from 
									hqyt_product_category
								where CATEGORY_ID in 
						<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
					        	#childCategoryS[]# 
					    </iterate>
						)
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamIds"> 
						hqyt_order.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						hqyt_order.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       hqyt_order.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       hqyt_order.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserOrAcc -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-OR-ACC" resultClass="java.util.HashMap">
	        SELECT
					<!-- IFNULL(h_reer.USER_ID,'') re_userid,
					IFNULL(IFNULL(h_reer.REAL_NAME, h_reer.NICK_NAME),'') re_name,
					IFNULL(h_reer.CELL,'') re_cell, -->
					IFNULL(h_oper.USER_ID,'') op_userid,
					IFNULL(IFNULL(h_oper.REAL_NAME, h_oper.NICK_NAME),'') op_name,
					IFNULL(h_oper.CELL,'') op_cell,
					IFNULL(h_oper.ERP_NO,'') op_erpNo,
					IFNULL(h_user.USER_ID,'') us_userid,
					IFNULL(IFNULL(h_user.REAL_NAME, h_user.NICK_NAME),'') us_name,
					IFNULL(h_user.CELL,'') us_cell,
					IFNULL(h_user.ERP_NO,'') us_erpNo,
					<isNotEmpty prepend="" property="childCategoryS"> 
					 IFNULL(hc.CATEGORY_NAME,'') cate_one,
					 hpc.CATEGORY_ID categoryId,
					</isNotEmpty>
					ho.PRODUCT_NAME productName,
					ho.ORDER_COUNT orderCount,
					ho.PRODUCT_OLD_PRICE productOldPrice,
					ho.ORDER_PRICE orderPrice,
					ho.PRODUCT_PRICE producePrice,
					ho.REAL_ORDER_PRICE payPrice,
					ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER realOrderPrice,
					ho.GMT_CREATE gmtCreate,
					ho.RECOMMEND_ID recommendId,
					ho.RECOMMEND_USER_ID recommendUserId,
					ho.RECOMMEND_TYPE recommendType,
					ho.ORDER_ID orderNo,
					ho.CHILD_ORDER_ID orderId,
					ht.TEAM_ID teamId,
					ht.TEAM_NAME teamName,
					ht.ERP_NO teamErpNo,
					CASE 
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NULL
					THEN -1
					WHEN ho.RECOMMEND_TYPE = '2' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					ELSE -1
					END AS isTeamUser
				FROM
					hqyt_order ho
				<isNotEmpty prepend="" property="childCategoryS"> 
				    LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID
				    LEFT JOIN hqyt_category  hc ON hc.ID = hpc.CATEGORY_ID
			    </isNotEmpty>
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_user h_oper ON h_oper.USER_ID = ho.CASHIER_USER
			   <!--  LEFT JOIN hqyt_user h_reer ON h_reer.USER_ID = ho.RECOMMEND_USER_ID -->
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID =  ho.TEAM_ID
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID =  ho.PRODUCT_ID
				WHERE 1 = 1
				<isNotEmpty prepend="AND" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		ht.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="AND" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		ht.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- 会员 -->
				<isEqual prepend="" property="userType" compareValue = "0">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.NICK_NAME,h_user.CELL,h_user.REAL_NAME,h_user.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 营业员 -->
				<isEqual prepend="" property="userType" compareValue = "1">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_oper.USER_ID,h_oper.NICK_NAME,h_oper.CELL,h_oper.REAL_NAME,h_oper.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 推荐人 -->
				<!-- <isNotEmpty prepend="AND" property="reerMsg">
					 CONCAT_WS(&apos; &apos;,h_reer.USER_ID,h_reer.NICK_NAME,h_reer.CELL,h_reer.REAL_NAME) like "%$reerMsg$%"
				</isNotEmpty> -->
				<!-- 门店 -->
				<isNotEmpty prepend="AND" property="teamIds"> 
						ho.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<!-- 商品信息 -->
				<isNotEmpty prepend="AND" property="proMsg">
					CONCAT_WS(&apos; &apos;,hp.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
						<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
								 #childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
				GROUP BY ho.CHILD_ORDER_ID
				<isEqual prepend="" property="isTeamUser" compareValue = "0">
					<![CDATA[
						HAVING isTeamUser = 0
					]]>      
				</isEqual>
				<isEqual prepend="" property="isTeamUser" compareValue = "1">
					<![CDATA[
						HAVING isTeamUser > 0
					]]>      
				</isEqual>
				ORDER BY ho.GMT_CREATE DESC
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
				<!-- <isEqual prepend="" property="userType" compareValue = "0">
					h_user.USER_ID
				</isEqual>
				<isEqual prepend="" property="userType" compareValue = "1">
					h_oper.USER_ID
				</isEqual>
				<isNotEmpty prepend="," property="teamIds"> 
					ho.TEAM_ID
				</isNotEmpty>
				<isNotEmpty prepend="," property="reerMsg"> 
					h_reer.USER_ID
				</isNotEmpty>
				<isNotEmpty prepend="," property="childCategoryS"> 
					hpc.CATEGORY_ID
				</isNotEmpty> -->
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserOrAccCount -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-OR-ACC-COUNT" resultClass="java.lang.Integer">
	        SELECT
					COUNT(1),
					CASE 
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NULL
					THEN -1
					WHEN ho.RECOMMEND_TYPE = '2' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					ELSE -1
					END AS isTeamUser
				FROM
					hqyt_order ho
				<isNotEmpty prepend="" property="childCategoryS"> 
				    LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID
				    LEFT JOIN hqyt_category  hc ON hc.ID = hpc.CATEGORY_ID
			    </isNotEmpty>
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_user h_oper ON h_oper.USER_ID = ho.CASHIER_USER
			   <!--  LEFT JOIN hqyt_user h_reer ON h_reer.USER_ID = ho.RECOMMEND_USER_ID -->
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID =  ho.TEAM_ID
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID =  ho.PRODUCT_ID
				WHERE 1 = 1
				<isNotEmpty prepend="AND" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		ht.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="AND" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		ht.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- 会员 -->
				<isEqual prepend="" property="userType" compareValue = "0">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.NICK_NAME,h_user.CELL,h_user.REAL_NAME,h_user.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 营业员 -->
				<isEqual prepend="" property="userType" compareValue = "1">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_oper.USER_ID,h_oper.NICK_NAME,h_oper.CELL,h_oper.REAL_NAME,h_oper.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 推荐人 -->
				<!-- <isNotEmpty prepend="AND" property="reerMsg">
					 CONCAT_WS(&apos; &apos;,h_reer.USER_ID,h_reer.NICK_NAME,h_reer.CELL,h_reer.REAL_NAME) like "%$reerMsg$%"
				</isNotEmpty> -->
				<!-- 门店 -->
				<isNotEmpty prepend="AND" property="teamIds"> 
						ho.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<!-- 商品信息 -->
				<isNotEmpty prepend="AND" property="proMsg">
					CONCAT_WS(&apos; &apos;,hp.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
						<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
								 #childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
				GROUP BY ho.CHILD_ORDER_ID
				<isEqual prepend="" property="isTeamUser" compareValue = "0">
					<![CDATA[
						HAVING 
							isTeamUser
						= 0
					]]>      
				</isEqual>
				<isEqual prepend="" property="isTeamUser" compareValue = "1">
					<![CDATA[
						HAVING 
							isTeamUser
						> 0
					]]>      
				</isEqual>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesForUsersOrStores -->
			 <select id="MS-ORDER-CALCULATE-SALES-FOR-USERS-OR-STORES" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER), 0) realPayPrice,
					IFNULL(SUM(ho.ORDER_COUNT), 0) realSalesNum
				FROM
					hqyt_order ho
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
				WHERE 1 = 1
				<isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.NICK_NAME,h_user.CELL,h_user.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="teamIds"> 
						ho.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>	
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserMsg -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-MSG" resultClass="java.util.HashMap">
	        SELECT
					h_user.USER_ID userId,
					h_user.NICK_NAME nickName,
					h_user.USER_LEVEL userLevel,
					h_user.REAL_NAME realName,
					h_user.SEX sex,
					h_user.CELL cell,
					MAX(ho.PROVINCE) province,
					MAX(ho.CITY) city,
					MAX(ho.AREA) area,
					MAX(ho.RE_ADDR) reAddr,
					h_user.AGE_GROUP ageGroup,
					<!-- (
					SELECT SUM(IFNULL(ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER, 0)) FROM hqyt_order 
					<isNotEmpty prepend="" property="childCategoryS"> 
						LEFT JOIN hqyt_product_category ON hqyt_product_category.PRODUCT_ID =  hqyt_order.PRODUCT_ID
					</isNotEmpty>
					WHERE hqyt_order.USER_ID = h_user.USER_ID
					<isNotEmpty prepend="and" property="childCategoryS"> 
						hqyt_product_category.CATEGORY_ID in 
					    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
							#childCategoryS[]# 
						</iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="orderStatus"> 
							hqyt_order.ORDER_STATE IN
							<iterate property="orderStatus" open="(" close=")" conjunction="," > 
						        #orderStatus[]# 
						    </iterate>
					</isNotEmpty>
					)
					realPayPrice,
					(
					SELECT COUNT(DISCOUNT hqyt_order.ORDER_ID) FROM hqyt_order 
					<isNotEmpty prepend="" property="childCategoryS"> 
						LEFT JOIN hqyt_product_category ON hqyt_product_category.PRODUCT_ID =  hqyt_order.PRODUCT_ID
					</isNotEmpty>
					WHERE hqyt_order.USER_ID = h_user.USER_ID
					<isNotEmpty prepend="and" property="childCategoryS"> 
						hqyt_product_category.CATEGORY_ID in 
					    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
							#childCategoryS[]# 
						</iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="orderStatus"> 
							hqyt_order.ORDER_STATE IN
							<iterate property="orderStatus" open="(" close=")" conjunction="," > 
						        #orderStatus[]# 
						    </iterate>
					</isNotEmpty>
					) 
					orderCount, -->
					<!-- SUM(IFNULL(ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER, 0)) realPayPrice,
					(SELECT COUNT(1) FROM hqyt_order WHERE USER_ID = ho.USER_ID) orderCount, -->
					ht.TEAM_ID teamId,
					ht.TEAM_NAME teamName,
					h_user.GMT_CREATE registerTime,
					re.USER_ID re_userId,
					IFNULL(re.REAL_NAME ,re.NICK_NAME) re_name,
					re.USER_LEVEL re_userLevel,
					re.CELL re_cell
				FROM
					hqyt_user h_user
			    LEFT JOIN hqyt_order ho ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
			    <!-- LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID -->
			    <!-- LEFT JOIN hqyt_category  hc on hc.ID = hpc.CATEGORY_ID -->
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID
			    LEFT JOIN hqyt_user re ON re.USER_ID = h_user.RECOMMEND_USER_ID
				WHERE 1 = 1
				
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.CELL,h_user.NICK_NAME,h_user.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="ageGroup">
						h_user.AGE_GROUP = #ageGroup#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="province">
						ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
						ht.CITY like "%$city$%"
				</isNotEmpty>
				
				<isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
				
				<isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
				
				GROUP BY ho.USER_ID  <!-- ho.ORDER_ID -->
				ORDER BY ho.GMT_CREATE
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserMsgCount -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-MSG-COUNT" resultClass="java.lang.Integer">
	        SELECT
					COUNT(1)
				FROM
				(
				SELECT
					ho.USER_ID
				FROM
					hqyt_user h_user
			    LEFT JOIN hqyt_order ho ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
			    <!-- LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID -->
			    <!-- LEFT JOIN hqyt_category  hc on hc.ID = hpc.CATEGORY_ID -->
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID
			    LEFT JOIN hqyt_user re ON re.USER_ID = h_user.RECOMMEND_USER_ID
				WHERE 1 = 1
				
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.CELL,h_user.NICK_NAME,h_user.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="ageGroup">
						h_user.AGE_GROUP = #ageGroup#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="province">
						ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
						ht.CITY like "%$city$%"
				</isNotEmpty>
				<!-- <isNotEmpty prepend="and" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
					    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
							#childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        #orderStatus[]# 
					    </iterate>
				</isNotEmpty> -->
				
				<isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
				<isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
				GROUP BY ho.USER_ID
				) x
    </select>

    <!-- mapped statement for IbatisOrderDAO.userSaleMoney -->
			 <select id="MS-ORDER-USER-SALE-MONEY" resultClass="java.util.HashMap">
	        SELECT 
							ho.USER_ID userId,
							IFNULL (SUM(ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER),0) realOrderAmount,
							IFNULL (SUM(ho.REAL_POINT_PRICE),0) realPointAmount,
							hu.USER_ID userId,
							IFNULL (hu.REAL_NAME,hu.NICK_NAME) userName,
							hu.CELL userCell,
							hus.USER_ID reuserId,
							IFNULL (hus.REAL_NAME,hus.NICK_NAME) reuserName,
							hus.CELL reuserCell
					FROM	
						 hqyt_order ho
					LEFT JOIN 
						hqyt_user hu
					ON ho.USER_ID = hu.USER_ID
					LEFT JOIN 
					  hqyt_user hus
					on hus.USER_ID = ho.RECOMMEND_USER_ID
					WHERE 1 = 1
					<isNotEmpty prepend="and" property="teamIds"> 
							ho.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="status"> 
							ho.ORDER_STATE IN
							<iterate property="status" open="(" close=")" conjunction="," > 
						        	#status[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="userMsg">
						CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.NICK_NAME,hu.CELL,hu.REAL_NAME) like "%$userMsg$%"
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,hus.USER_ID,hus.NICK_NAME,hus.CELL,hus.REAL_NAME) like "%$reMsg$%"
					</isNotEmpty>
					<isNotEmpty property="startTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE >= #startTime#
						    ]]>      
					</isNotEmpty>
					<isNotEmpty property="endTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE < #endTime#
						    ]]>      
					</isNotEmpty>
					GROUP BY ho.USER_ID
					ORDER BY 
 						realOrderAmount DESC
					<isNotEmpty property="offset">
						   limit #offset#,#limit#  
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.userSaleMoneyCount -->
			 <select id="MS-ORDER-USER-SALE-MONEY-COUNT" resultClass="int">
	        SELECT 
						COUNT(1) 
					FROM
					(
						SELECT 
								ho.USER_ID userId
						FROM	
							 hqyt_order ho
						LEFT JOIN 
							hqyt_user hu
						ON ho.USER_ID = hu.USER_ID
						LEFT JOIN 
						  hqyt_user hus
						on hus.USER_ID = ho.RECOMMEND_USER_ID
						WHERE 1 = 1
						<isNotEmpty prepend="and" property="teamIds"> 
								ho.TEAM_ID IN
								<iterate property="teamIds" open="(" close=")" conjunction="," > 
							        	#teamIds[]# 
							    </iterate>
						</isNotEmpty>
						<isNotEmpty prepend="and" property="status"> 
								ho.ORDER_STATE IN
								<iterate property="status" open="(" close=")" conjunction="," > 
							        	#status[]# 
							    </iterate>
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="userMsg">
							CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.NICK_NAME,hu.CELL,hu.REAL_NAME) like "%$userMsg$%"
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="reMsg">
							CONCAT_WS(&apos; &apos;,hus.USER_ID,hus.NICK_NAME,hus.CELL,hus.REAL_NAME) like "%$reMsg$%"
						</isNotEmpty>
						<isNotEmpty property="startTime" prepend="and">
							    <![CDATA[
							       ho.GMT_CREATE >= #startTime#
							    ]]>      
						</isNotEmpty>
						<isNotEmpty property="endTime" prepend="and">
							    <![CDATA[
							       ho.GMT_CREATE < #endTime#
							    ]]>      
						</isNotEmpty>
						GROUP BY ho.USER_ID
					) re
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllCashierOrderList -->
			 <select id="MS-ORDER-QUERY-ALL-CASHIER-ORDER-LIST" resultClass="java.util.HashMap">
	        SELECT
					ho.ORDER_ID orderNo,
					ho.CHILD_ORDER_ID orderId,
					ho.GMT_CREATE gmtCreate,
					ho.GMT_MODIFIED gmtModified,
					ho.CASHIER_DISCOUNT cashierDiscount,
					ho.ORDER_COUNT orderCount,
					ho.PRODUCT_PRICE productPrice,
					ho.PRODUCT_OLD_PRICE productOldPrice,
					ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER realOrderPrice,
					ho.REDUCE_AMOUNT_VOUCHER amountVoucher,
					ho.ORDER_PRICE oldSalePrice,
					ho.ORDER_STATE orderStatus,
					ho.SUB_ORDER_STATUS orderSubStatus,
					ho.PRODUCT_ID productId,
					ho.PRODUCT_NAME productName,
					hp.ERP_NO productErpNo,
					ht.TEAM_NAME teamName,
					ht.TEAM_LEVEL teamLevel,
					ht.ERP_NO teamErpNo,
					oper.USER_ID op_userId,
					oper.CELL op_cell,
					oper.ERP_NO op_erpNo,
					IFNULL(oper.REAL_NAME, oper.NICK_NAME) op_name,
					ou.USER_ID buy_userId,
					ou.CELL buy_cell,
					IFNULL(ou.REAL_NAME, ou.NICK_NAME) buy_name,
					ou.USER_LEVEL buy_userLevel
				FROM hqyt_order ho
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        AND ho.CASHIER_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="teamIds"> 
					ho.TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						 #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="cashierUserMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.NICK_NAME,oper.REAL_NAME,oper.ERP_NO) like "%$cashierUserMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_ZJM,hp.RANK_NUM) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.NICK_NAME,ou.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty property="orderNo" prepend="and">
		             	ho.ORDER_ID =  #orderNo#
		        </isNotEmpty>
		        <isNotEmpty property="orderId" prepend="and">
		             	ho.CHILD_ORDER_ID =  #orderId#
		        </isNotEmpty>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
				ORDER BY ho.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllCashierOrderListCount -->
			 <select id="MS-ORDER-QUERY-ALL-CASHIER-ORDER-LIST-COUNT" resultClass="java.lang.Integer">
	        SELECT
					COUNT(1)
				FROM hqyt_order ho
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        AND ho.CASHIER_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="teamIds"> 
					ho.TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						 #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="cashierUserMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.NICK_NAME,oper.REAL_NAME,oper.ERP_NO) like "%$cashierUserMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_ZJM,hp.RANK_NUM) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.NICK_NAME,ou.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty property="orderNo" prepend="and">
		             	ho.ORDER_ID =  #orderNo#
		        </isNotEmpty>
		        <isNotEmpty property="orderId" prepend="and">
		             	ho.CHILD_ORDER_ID =  #orderId#
		        </isNotEmpty>
		        
		       	<isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.sumAllMoney -->
			 <select id="MS-ORDER-SUM-ALL-MONEY" resultClass="java.math.BigDecimal">
	        SELECT 
						IFNULL(SUM(ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER),0) realOrderAmount
					FROM	
						 hqyt_order ho
					WHERE 1 = 1
					<isNotEmpty prepend="and" property="teamIds"> 
							ho.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="status"> 
							ho.ORDER_STATE IN
							<iterate property="status" open="(" close=")" conjunction="," > 
						        	#status[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty property="startTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE >= #startTime#
						    ]]>      
					</isNotEmpty>
					<isNotEmpty property="endTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE < #endTime#
						    ]]>      
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.sumAllMoneyTeam -->
			 <select id="MS-ORDER-SUM-ALL-MONEY-TEAM" resultClass="java.math.BigDecimal">
	        SELECT 
						IFNULL(SUM(ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER),0)
					FROM	
						 hqyt_order ho
					WHERE 1 = 1
					<isNotEmpty prepend="and" property="userIds"> 
							ho.CASHIER_USER IN
							<iterate property="userIds" open="(" close=")" conjunction="," > 
						        	#userIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="status"> 
							ho.ORDER_STATE IN
							<iterate property="status" open="(" close=")" conjunction="," > 
						        	#status[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty property="startTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE >= #startTime#
						    ]]>      
					</isNotEmpty>
					<isNotEmpty property="endTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE < #endTime#
						    ]]>      
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllDiscountUseListS -->
			 <select id="MS-ORDER-QUERY-ALL-DISCOUNT-USE-LIST-S" resultClass="java.util.HashMap">
	        SELECT
							result3.ORDER_ID orderNo,
							result3.CHILD_ORDER_ID orderId,
							hqyt_user.CELL userCell,
							result3.PRODUCT_NAME proName,
							hqyt_team.TEAM_ID teamId,
							hqyt_team.TEAM_NAME teamName,
							hqyt_team.ERP_NO teamErpNo,
							hqyt_team.ADDRESS teamAddress,
							hqyt_team.CITY teamCity,
							result3.ORDER_PRICE orderPrice,
							result3.GMT_CREATE gmtCreate,
							substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) discountId,
							IFNULL(substring_index(
								substring_index(
									result3.replaceJsonA,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							),0) amount
				FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result3.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result3.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) like concat('%',#discountId#,'%')
				</isNotEmpty>
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result3.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result3.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
				ORDER BY result3.GMT_CREATE DESC
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllDiscountUseListCountS -->
			 <select id="MS-ORDER-QUERY-ALL-DISCOUNT-USE-LIST-COUNT-S" resultClass="int">
	        SELECT
					COUNT(1)
				FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result3.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result3.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) like concat('%',#discountId#,'%')
				</isNotEmpty>
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result3.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result3.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.sumAllDiscountUseListS -->
			 <select id="MS-ORDER-SUM-ALL-DISCOUNT-USE-LIST-S" resultClass="java.util.HashMap">
	        SELECT
					SUM(result3.ORDER_PRICE) orderPrice,
					SUM(IFNULL(substring_index(
								substring_index(
									result3.replaceJsonA,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1),0)
					) amount
				FROM
							(
								SELECT
									*, REPLACE (
										REPLACE (
											replace_json (result2.discountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJson,
									REPLACE (
										REPLACE (
											replace_json (result2.amountJson),
											'"',
											''
										),
										' ',
										''
									) replaceJsonA
								FROM
									(
										SELECT
											*, JSON_EXTRACT (
												result.discountMsg,
												'$$**.discountId'
											) AS discountJson,
											JSON_EXTRACT (
												result.discountMsg,
												'$$**.amount'
											) AS amountJson
										FROM
											(
												SELECT
													*, JSON_MERGE (
														IFNULL(REDUCE_TEAM, '[]'),
														IFNULL(REDUCE_PLAT, '[]'),
														IFNULL(REDUCE_PRO, '[]')
													) discountMsg
												FROM
													hqyt_order
												WHERE
													(
														ISNULL(REDUCE_TEAM) = 0
														OR ISNULL(REDUCE_PLAT) = 0
														OR ISNULL(REDUCE_PRO) = 0
													)
											) result
									) result2
							) result3
						JOIN help_topic_copy b ON b.help_topic_id <![CDATA[< ]]> (
							length(result3.replaceJson) - length(
								REPLACE (result3.replaceJson, ',', '')
							) + 1
						)
				LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = result3.TEAM_ID
				LEFT JOIN hqyt_user ON hqyt_user.USER_ID = result3.USER_ID
				WHERE 1=1
				<isNotEmpty prepend="and" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		hqyt_team.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="and" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		hqyt_team.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,hqyt_team.TEAM_ID,hqyt_team.TEAM_NAME,hqyt_team.ERP_NO) like concat('%',#teamMsg#,'%')
				</isNotEmpty>
				<isNotEmpty prepend="and" property="discountId">
					substring_index(
								substring_index(
									result3.replaceJson,
									',',
									b.help_topic_id + 1
								),
								',' ,- 1
							) like concat('%',#discountId#,'%')
				</isNotEmpty>
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	result3.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                result3.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllCashierOrderListSum -->
			 <select id="MS-ORDER-QUERY-ALL-CASHIER-ORDER-LIST-SUM" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(ho.ORDER_COUNT),0) orderCountSum,
					IFNULL(SUM(ho.PRODUCT_PRICE),0) productPriceSum,
					IFNULL(SUM(ho.PRODUCT_OLD_PRICE),0) productOldPriceSum,
					IFNULL(SUM(ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER),0) realOrderPriceSum,
					IFNULL(SUM(ho.REDUCE_AMOUNT_VOUCHER),0) amountVoucherSum,
					IFNULL(SUM(ho.ORDER_PRICE),0) oldSalePriceSum,
					IFNULL(SUM(ho.CASHIER_DISCOUNT),0) cashierDiscountSum
				FROM hqyt_order ho
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        AND ho.CASHIER_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="teamIds"> 
					ho.TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						 #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="cashierUserMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.NICK_NAME,oper.REAL_NAME,oper.ERP_NO) like "%$cashierUserMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_ZJM,hp.RANK_NUM) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.NICK_NAME,ou.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty property="orderNo" prepend="and">
		             	ho.ORDER_ID =  #orderNo#
		        </isNotEmpty>
		        <isNotEmpty property="orderId" prepend="and">
		             	ho.CHILD_ORDER_ID =  #orderId#
		        </isNotEmpty>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllCashierOrderListIds -->
			 <select id="MS-ORDER-QUERY-ALL-CASHIER-ORDER-LIST-IDS" resultClass="java.lang.String">
	        SELECT
					ho.CHILD_ORDER_ID orderId
				FROM hqyt_order ho
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        AND ho.CASHIER_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="teamIds"> 
					ho.TEAM_ID IN
					<iterate property="teamIds" open="(" close=")" conjunction="," > 
						 #teamIds[]# 
					</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="cashierUserMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.NICK_NAME,oper.REAL_NAME,oper.ERP_NO) like "%$cashierUserMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_ZJM,hp.RANK_NUM) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.NICK_NAME,ou.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty property="orderNo" prepend="and">
		             	ho.ORDER_ID =  #orderNo#
		        </isNotEmpty>
		        <isNotEmpty property="orderId" prepend="and">
		             	ho.CHILD_ORDER_ID =  #orderId#
		        </isNotEmpty>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserOrAccSum -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-OR-ACC-SUM" resultClass="java.util.HashMap">
	        SELECT 
					IFNULL(SUM(result.orderCount),0) orderCountSum,
					IFNULL(SUM(result.orderPrice),0) orderPriceSum,
					IFNULL(SUM(result.payPrice),0) payPriceSum,
					IFNULL(SUM(result.realOrderPrice),0) realOrderPriceSum
				FROM 
				(
				SELECT
					ho.ORDER_COUNT orderCount,
					ho.ORDER_PRICE orderPrice,
					ho.REAL_ORDER_PRICE payPrice,
					ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER realOrderPrice,
					CASE 
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_ID)  
					WHEN ho.RECOMMEND_TYPE = '1' AND ho.RECOMMEND_USER_ID IS NULL AND ho.RECOMMEND_ID IS NULL
					THEN -1
					WHEN ho.RECOMMEND_TYPE = '2' AND ho.RECOMMEND_USER_ID IS NOT NULL
					THEN (SELECT COUNT(1) FROM hqyt_team_user WHERE TEAM_USER_ID = ho.RECOMMEND_USER_ID)  
					ELSE -1
					END AS isTeamUser
				FROM
					hqyt_order ho
				<isNotEmpty prepend="" property="childCategoryS"> 
				    LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID
				    LEFT JOIN hqyt_category  hc ON hc.ID = hpc.CATEGORY_ID
			    </isNotEmpty>
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_user h_oper ON h_oper.USER_ID = ho.CASHIER_USER
			   <!--  LEFT JOIN hqyt_user h_reer ON h_reer.USER_ID = ho.RECOMMEND_USER_ID -->
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID =  ho.TEAM_ID
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID =  ho.PRODUCT_ID
				WHERE 1 = 1
				<isNotEmpty prepend="AND" property="province"> 
					<iterate property="province" open="(" close=")" conjunction="or" > 
		        		ht.ADDRESS like concat('%',#province[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
		    	<isNotEmpty prepend="AND" property="city"> 
					<iterate property="city" open="(" close=")" conjunction="or" > 
		        		ht.CITY like concat('%',#city[]#,'%')
		        	</iterate>
		    	</isNotEmpty>
				<!-- 会员 -->
				<isEqual prepend="" property="userType" compareValue = "0">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.NICK_NAME,h_user.CELL,h_user.REAL_NAME,h_user.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 营业员 -->
				<isEqual prepend="" property="userType" compareValue = "1">
					<isNotEmpty prepend="AND" property="someMsg">
						CONCAT_WS(&apos; &apos;,h_oper.USER_ID,h_oper.NICK_NAME,h_oper.CELL,h_oper.REAL_NAME,h_oper.ERP_NO) like "%$someMsg$%"
					</isNotEmpty>
				</isEqual>
				<!-- 推荐人 -->
				<!-- <isNotEmpty prepend="AND" property="reerMsg">
					 CONCAT_WS(&apos; &apos;,h_reer.USER_ID,h_reer.NICK_NAME,h_reer.CELL,h_reer.REAL_NAME) like "%$reerMsg$%"
				</isNotEmpty> -->
				<!-- 门店 -->
				<isNotEmpty prepend="AND" property="teamIds"> 
						ho.TEAM_ID IN
						<iterate property="teamIds" open="(" close=")" conjunction="," > 
					        	#teamIds[]# 
					    </iterate>
				</isNotEmpty>
				<!-- 商品信息 -->
				<isNotEmpty prepend="AND" property="proMsg">
					CONCAT_WS(&apos; &apos;,hp.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME,hp.PRO_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
						<iterate property="childCategoryS" open="(" close=")" conjunction="," > 
								 #childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        	#orderStatus[]# 
					    </iterate>
				</isNotEmpty>	
				<isNotEmpty property="startDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE >= #startDate#
					    ]]>      
				</isNotEmpty>
				<isNotEmpty property="endDate" prepend="and">
					    <![CDATA[
					       ho.GMT_CREATE < #endDate#
					    ]]>      
				</isNotEmpty>
				GROUP BY ho.CHILD_ORDER_ID
				<isEqual prepend="" property="isTeamUser" compareValue = "0">
					<![CDATA[
						HAVING isTeamUser = 0
					]]>      
				</isEqual>
				<isEqual prepend="" property="isTeamUser" compareValue = "1">
					<![CDATA[
						HAVING isTeamUser > 0
					]]>      
				</isEqual>
				) result
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserMsgSum -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-MSG-SUM" resultClass="java.util.HashMap">
	        SELECT
					SUM(IFNULL(ho.REAL_ORDER_PRICE+ho.REDUCE_AMOUNT_VOUCHER, 0)) realPayPriceSum
					<!-- SUM((SELECT COUNT(1) FROM hqyt_order WHERE USER_ID = ho.USER_ID)) orderCountSum -->
				FROM
					hqyt_order ho
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
			    <isNotEmpty prepend="" property="childCategoryS"> 
				    LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID
				    LEFT JOIN hqyt_category  hc on hc.ID = hpc.CATEGORY_ID
				</isNotEmpty>
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID
			    LEFT JOIN hqyt_user re ON re.USER_ID = ho.RECOMMEND_USER_ID
				WHERE 1 = 1
				
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.CELL,h_user.NICK_NAME,h_user.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="ageGroup">
						h_user.AGE_GROUP = #ageGroup#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="province">
						ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
						ht.CITY like "%$city$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
					    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
							#childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        #orderStatus[]# 
					    </iterate>
				</isNotEmpty>
				
				<isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
				
				<isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
    </select>

    <!-- mapped statement for IbatisOrderDAO.calculateSalesCategoryForUserMsgUserIds -->
			 <select id="MS-ORDER-CALCULATE-SALES-CATEGORY-FOR-USER-MSG-USER-IDS" resultClass="java.lang.String">
	        SELECT
					ho.USER_ID
				FROM
					hqyt_order ho
			    LEFT JOIN hqyt_user h_user ON h_user.USER_ID = ho.USER_ID
			    LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
			   <!--  LEFT JOIN hqyt_product_category hpc ON hpc.PRODUCT_ID =  ho.PRODUCT_ID
			    LEFT JOIN hqyt_category  hc on hc.ID = hpc.CATEGORY_ID -->
			    LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID
			    LEFT JOIN hqyt_user re ON re.USER_ID = ho.RECOMMEND_USER_ID
				WHERE 1 = 1
				
				<isNotEmpty prepend="and" property="buyMsg">
					CONCAT_WS(&apos; &apos;,h_user.USER_ID,h_user.CELL,h_user.NICK_NAME,h_user.REAL_NAME) like "%$buyMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="ageGroup">
						h_user.AGE_GROUP = #ageGroup#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="province">
						ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
						ht.CITY like "%$city$%"
				</isNotEmpty>
				
				<!-- <isNotEmpty prepend="and" property="childCategoryS"> 
						hpc.CATEGORY_ID in 
					    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
							#childCategoryS[]# 
						</iterate>
				</isNotEmpty>
				<isNotEmpty prepend="and" property="orderStatus"> 
						ho.ORDER_STATE IN
						<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					        #orderStatus[]# 
					    </iterate>
				</isNotEmpty> -->
				
				<isNotEmpty property="startTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE >= #startTime#
					]]>      
				</isNotEmpty>
				<isNotEmpty property="endTime" prepend="and">
					<![CDATA[
						 ho.GMT_CREATE < #endTime#
					]]>      
				</isNotEmpty>
				
				<isEqual prepend="" property="specialyFlg" compareValue = "true">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID = #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
		        
		        <isEqual prepend="" property="specialyFlg" compareValue = "false">
		        	<isNotEmpty property="specialyUid" prepend="and">
		             	ho.USER_ID &lt;&gt; #specialyUid#
		        	</isNotEmpty>
		        </isEqual>
				
				GROUP BY ho.USER_ID
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryMyVoucherSumCount -->
			 <select id="MS-ORDER-QUERY-MY-VOUCHER-SUM-COUNT" resultClass="java.lang.Integer">
	        SELECT COUNT(1) FROM hqyt_order
			 WHERE 1 = 1 
			 <isNotEmpty prepend="and" property="userIds"> 
					USER_ID IN 
				<iterate property="userIds" open="(" close=")" conjunction="," > 
						#userIds[]# 
				</iterate>
			 </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneySum -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-SUM" resultClass="java.math.BigDecimal">
	        SELECT
						IFNULL(
							sum(
								ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER
							),
							0
						) realOrderAmountSum
					FROM
						hqyt_order ho
					LEFT JOIN hqyt_user hus ON hus.USER_ID = ho.USER_ID
					LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
					LEFT JOIN hqyt_user ru ON ru.USER_ID = hus.RECOMMEND_USER_ID
					WHERE 1 = 1
					AND hus.RECOMMEND_USER_ID IS NOT NULL
					<isNotEmpty prepend="and" property="teamIds"> 
							ho.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="status"> 
							ho.ORDER_STATE IN
							<iterate property="status" open="(" close=")" conjunction="," > 
						        	#status[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,ru.USER_ID,ru.NICK_NAME,ru.CELL,ru.REAL_NAME) like "%$reMsg$%"
					</isNotEmpty>
					<isNotEmpty property="startTime" prepend="and">
						    <![CDATA[
						       ho.PAY_DATE >= #startTime#
						    ]]>      
					</isNotEmpty>
					<isNotEmpty property="endTime" prepend="and">
						    <![CDATA[
						       ho.PAY_DATE < #endTime#
						    ]]>      
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.userSaleMoneySum -->
			 <select id="MS-ORDER-USER-SALE-MONEY-SUM" resultClass="java.math.BigDecimal">
	        SELECT 
						IFNULL (SUM(ho.REAL_ORDER_PRICE + ho.REDUCE_AMOUNT_VOUCHER),0) realOrderAmountSum
					FROM	
						 hqyt_order ho
					LEFT JOIN 
						hqyt_user hu
					ON ho.USER_ID = hu.USER_ID
					LEFT JOIN 
					  hqyt_user hus
					on hus.USER_ID = ho.RECOMMEND_USER_ID
					WHERE 1 = 1
					<isNotEmpty prepend="and" property="teamIds"> 
							ho.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="and" property="status"> 
							ho.ORDER_STATE IN
							<iterate property="status" open="(" close=")" conjunction="," > 
						        	#status[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="userMsg">
						CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.NICK_NAME,hu.CELL,hu.REAL_NAME) like "%$userMsg$%"
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,hus.USER_ID,hus.NICK_NAME,hus.CELL,hus.REAL_NAME) like "%$reMsg$%"
					</isNotEmpty>
					<isNotEmpty property="startTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE >= #startTime#
						    ]]>      
					</isNotEmpty>
					<isNotEmpty property="endTime" prepend="and">
						    <![CDATA[
						       ho.GMT_CREATE < #endTime#
						    ]]>      
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryAllSaleCheckSum -->
			 <select id="MS-ORDER-QUERY-ALL-SALE-CHECK-SUM" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(ho.ORDER_COUNT),0) orderCountSum,
					IFNULL(SUM(ho.PRODUCT_PRICE),0) productPriceSum,
					IFNULL(SUM(ho.PRODUCT_OLD_PRICE),0) productOldPriceSum,
					IFNULL(SUM(ho.REAL_ORDER_PRICE),0) realOrderPriceSum,
					IFNULL(SUM(ho.ORDER_PRICE),0) orderPriceSum
				FROM hqyt_order ho
				LEFT JOIN hqyt_user ywer ON ywer.USER_ID = ho.REASION_USER 
				LEFT JOIN hqyt_user dqer ON dqer.USER_ID = ho.REASON_BANS_USER 
				LEFT JOIN hqyt_user oper ON oper.USER_ID = ho.CASHIER_USER 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = ho.TEAM_ID
				LEFT JOIN hqyt_user ou ON ou.USER_ID = ho.USER_ID 
				LEFT JOIN hqyt_product hp ON hp.PRODUCT_ID = ho.PRODUCT_ID 
		        WHERE 1 = 1 
		        and 
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT > 0
		            ]]>    
		        and
		        	<![CDATA[
		                ho.CASHIER_DISCOUNT < 1
		            ]]>   
		        and REASION_USER IS NOT NULL
		        <isNotEmpty prepend="and" property="province">
					ht.ADDRESS like "%$province$%"
				</isNotEmpty>
				<isNotEmpty prepend="and" property="city">
					ht.CITY like "%$city$%"
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="operMsg">
					CONCAT_WS(&apos; &apos;,oper.USER_ID,oper.CELL,oper.REAL_NAME) like "%$operMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="ywerMsg">
					CONCAT_WS(&apos; &apos;,ywer.USER_ID,ywer.CELL,ywer.REAL_NAME) like "%$ywerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="dqerMsg">
					CONCAT_WS(&apos; &apos;,dqer.USER_ID,dqer.CELL,dqer.REAL_NAME) like "%$dqerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDateYw" prepend="and">
		            <![CDATA[
		             	ho.REASION_TIME >=  #startDateYw#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateYw" prepend="and">
		             <![CDATA[
		                ho.REASION_TIME <= #endDateYw#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateDq" prepend="and">
		            <![CDATA[
		             	ho.REASON_BANS_TIME >=  #startDateDq#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateDq" prepend="and">
		             <![CDATA[
		                ho.REASON_BANS_TIME <= #endDateDq#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty property="startDateOrder" prepend="and">
		            <![CDATA[
		             	ho.GMT_CREATE >=  #startDateOrder#
		            ]]>        
		        </isNotEmpty>
		        <isNotEmpty property="endDateOrder" prepend="and">
		             <![CDATA[
		                ho.GMT_CREATE <= #endDateOrder#
		             ]]>      
		        </isNotEmpty>
		        
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,ou.USER_ID,ou.CELL,ou.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="proMsg">
					CONCAT_WS(&apos; &apos;,ho.PRODUCT_ID,hp.ERP_NO,ho.PRODUCT_NAME) like "%$proMsg$%"
				</isNotEmpty>
				
				<!-- 业务审核通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "0">
						( 
							ho.ORDER_STATE NOT IN ('13','14') OR 
							(
								ho.ORDER_STATE = '13' AND ho.SUB_ORDER_STATUS = '13.2'
							)
					 	)
				</isEqual>
				<!-- 业务审核不通过 -->
				<isEqual prepend="and" property="ywCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.1'
				</isEqual>
				
				<!-- 大区审核通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "0">
						ho.ORDER_STATE NOT IN ('13','14')
				</isEqual>
				<!-- 大区审核不通过 -->
				<isEqual prepend="and" property="dqCheckStatus" compareValue = "1">
						ho.ORDER_STATE = '14' AND ho.SUB_ORDER_STATUS = '13.2'
				</isEqual>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryOrderPriceSum -->
			 <select id="MS-ORDER-QUERY-ORDER-PRICE-SUM" resultClass="java.math.BigDecimal">
	        SELECT 
			 	SUM(IFNULL(hqyt_order.REAL_ORDER_PRICE+hqyt_order.REDUCE_AMOUNT_VOUCHER, 0)) realPayPrice_sum
			 FROM hqyt_order 
			 <isNotEmpty prepend="" property="childCategoryS"> 
			 	LEFT JOIN hqyt_product_category ON hqyt_product_category.PRODUCT_ID =  hqyt_order.PRODUCT_ID
			 </isNotEmpty>
			 WHERE 1=1
			 <isNotEmpty prepend="and" property="userId"> 
				hqyt_order.USER_ID = #userId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="userIds"> 
				hqyt_order.USER_ID IN 
				<iterate property="userIds" open="(" close=")" conjunction="," > 
						#userIds[]# 
				</iterate>
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="childCategoryS"> 
				hqyt_product_category.CATEGORY_ID in 
			    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
					#childCategoryS[]# 
				</iterate>
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="orderStatus"> 
				hqyt_order.ORDER_STATE IN
				<iterate property="orderStatus" open="(" close=")" conjunction="," > 
					#orderStatus[]# 
				</iterate>
			 </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.queryOrderCountSum -->
			 <select id="MS-ORDER-QUERY-ORDER-COUNT-SUM" resultClass="java.lang.Double">
	        SELECT 
			 	COUNT(DISTINCT hqyt_order.ORDER_ID) orderCount_sum
			 FROM hqyt_order 
			 <isNotEmpty prepend="" property="childCategoryS"> 
			 	LEFT JOIN hqyt_product_category ON hqyt_product_category.PRODUCT_ID =  hqyt_order.PRODUCT_ID
			 </isNotEmpty>
			 WHERE 1=1
			 <isNotEmpty prepend="and" property="userId"> 
				hqyt_order.USER_ID = #userId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="userIds"> 
				hqyt_order.USER_ID IN 
				<iterate property="userIds" open="(" close=")" conjunction="," > 
						#userIds[]# 
				</iterate>
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="childCategoryS"> 
				hqyt_product_category.CATEGORY_ID in 
			    <iterate property="childCategoryS" open="(" close=")" conjunction="," > 
					#childCategoryS[]# 
				</iterate>
			 </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUser -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER" resultClass="java.util.HashMap">
	        SELECT
						re_user.USER_ID re_userId,
						IFNULL(re_user.REAL_NAME,re_user.NICK_NAME) re_name,
						re_user.CELL re_cell,
						re_user.USER_LEVEL re_level,
						re_user.ERP_NO re_erpNo,
						<!-- 邀请注册的人数(推荐人数) -->
						(
							SELECT COUNT(1) FROM hqyt_user hu WHERE  hu.RECOMMEND_USER_ID = re_user.USER_ID
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) re_user_count,
						<!-- 邀请注册后消费的人数(推荐消费人数) -->
						SUM((
							SELECT COUNT(DISTINCT ho.USER_ID) FROM hqyt_order ho WHERE ho.USER_ID = o_user.USER_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						))re_buy_count,
						<!-- 邀请注册后消费的金额(推荐销售金额) -->
						SUM((
							SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho WHERE  ho.USER_ID = o_user.USER_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)) re_buy_amount,
						(
							SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho WHERE  ho.CASHIER_USER = re_user.USER_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) u_buy_amount,
						team.TEAM_ID teamId,
						team.ERP_NO teamErpNo,
						team.TEAM_NAME teamName
					FROM
						hqyt_user o_user
					LEFT JOIN hqyt_user re_user ON re_user.USER_ID = o_user.RECOMMEND_USER_ID
					LEFT JOIN hqyt_team_user team_user ON team_user.TEAM_USER_ID = re_user.USER_ID
					LEFT JOIN hqyt_team team ON team.TEAM_ID = team_user.TEAM_ID
					WHERE 
					o_user.USER_ID IN (
						SELECT
							USER_ID
						FROM
							hqyt_user
						WHERE
							RECOMMEND_USER_ID IS NOT NULL
					)
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,re_user.USER_ID,re_user.NICK_NAME,re_user.CELL,re_user.REAL_NAME,re_user.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
					GROUP BY re_user.USER_ID
					ORDER BY re_buy_amount DESC
					<isNotEmpty property="offset">
						  limit #offset#,#limit#  
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUserCount -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER-COUNT" resultClass="int">
	        SELECT 
					COUNT(1)
				FROM (
					SELECT
						re_user.USER_ID
					FROM
						hqyt_user o_user
					LEFT JOIN hqyt_user re_user ON re_user.USER_ID = o_user.RECOMMEND_USER_ID
					LEFT JOIN hqyt_team_user team_user ON team_user.TEAM_USER_ID = re_user.USER_ID
					LEFT JOIN hqyt_team team ON team.TEAM_ID = team_user.TEAM_ID
					WHERE 
					o_user.USER_ID IN (
						SELECT
							USER_ID
						FROM
							hqyt_user
						WHERE
							RECOMMEND_USER_ID IS NOT NULL
					)
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,re_user.USER_ID,re_user.NICK_NAME,re_user.CELL,re_user.REAL_NAME,re_user.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
					GROUP BY re_user.USER_ID
				) a
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendTeam -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-TEAM" resultClass="java.util.HashMap">
	        SELECT
						team.TEAM_ID teamId,
						team.ERP_NO teamErpNo,
						team.TEAM_NAME teamName,
						<!-- 关于团队的总消费金额   -->
						(	SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho 
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) all_team_amount,
						<!-- 会员销售金额 -->
						(
							SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="unifyUserIds"> 
									ho.USER_ID NOT IN
									<iterate property="unifyUserIds" open="(" close=")" conjunction="," > 
								        	#unifyUserIds[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) u_buy_amount,
						<!-- 关于团队的总消费人数 -->
						(
							SELECT COUNT(DISTINCT ho.USER_ID) FROM hqyt_order ho 
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) all_team_count,
						<!-- 推荐人数 -->
						(
							SELECT COUNT(1) FROM hqyt_user hu 
							WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID)
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) re_user_count,
						<!-- 推荐消费人数  通过这个团队的成员邀请注册后有消费的人数-->
						(
							SELECT COUNT(DISTINCT ho.USER_ID) FROM hqyt_order ho 
							WHERE ho.USER_ID IN 
							(SELECT USER_ID FROM hqyt_user hu WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID))
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						) re_buy_count,
						(
							SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order ho 
							WHERE ho.USER_ID IN 
							(SELECT USER_ID FROM hqyt_user hu WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID))
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)re_buy_amount
					FROM
						hqyt_team team
					WHERE 1=1
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,team.TEAM_ID,team.TEAM_NAME,team.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
					ORDER BY re_buy_amount DESC
					<isNotEmpty property="offset">
						  limit #offset#,#limit#  
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendTeamCount -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-TEAM-COUNT" resultClass="int">
	        SELECT
						COUNT(1)
					FROM
						hqyt_team team
					WHERE 1=1
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,team.TEAM_ID,team.TEAM_NAME,team.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUserRList -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER-R-LIST" resultClass="java.lang.String">
	        SELECT
						re_user.USER_ID re_userId
					FROM
						hqyt_user o_user
					LEFT JOIN hqyt_user re_user ON re_user.USER_ID = o_user.RECOMMEND_USER_ID
					LEFT JOIN hqyt_team_user team_user ON team_user.TEAM_USER_ID = re_user.USER_ID
					LEFT JOIN hqyt_team team ON team.TEAM_ID = team_user.TEAM_ID
					WHERE 
					o_user.USER_ID IN (
						SELECT
							USER_ID
						FROM
							hqyt_user
						WHERE
							RECOMMEND_USER_ID IS NOT NULL
					)
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,re_user.USER_ID,re_user.NICK_NAME,re_user.CELL,re_user.REAL_NAME,re_user.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
					GROUP BY re_user.USER_ID
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUserOList -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER-O-LIST" resultClass="java.lang.String">
	        SELECT
						DISTINCT o_user.USER_ID ou_userId
					FROM
						hqyt_user o_user
					LEFT JOIN hqyt_user re_user ON re_user.USER_ID = o_user.RECOMMEND_USER_ID
					LEFT JOIN hqyt_team_user team_user ON team_user.TEAM_USER_ID = re_user.USER_ID
					LEFT JOIN hqyt_team team ON team.TEAM_ID = team_user.TEAM_ID
					WHERE 
					o_user.USER_ID IN (
						SELECT
							USER_ID
						FROM
							hqyt_user
						WHERE
							RECOMMEND_USER_ID IS NOT NULL
					)
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,re_user.USER_ID,re_user.NICK_NAME,re_user.CELL,re_user.REAL_NAME,re_user.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUserReSum -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER-RE-SUM" resultClass="java.util.HashMap">
	        SELECT 
								COUNT(DISTINCT ho.USER_ID) re_buy_count_sum,
								IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) re_buy_amount_sum
							FROM hqyt_order ho  
							WHERE 1 = 1
							<isNotEmpty prepend="AND" property="userIds"> 
									ho.USER_ID IN
									<iterate property="userIds" open="(" close=")" conjunction="," > 
								        	#userIds[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendUserOuSum -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-USER-OU-SUM" resultClass=" java.math.BigDecimal">
	        SELECT 
							IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) 
						FROM 
						hqyt_order  ho 
						WHERE 1 = 1
						<isNotEmpty prepend="AND" property="userIds"> 
								ho.CASHIER_USER IN
								<iterate property="userIds" open="(" close=")" conjunction="," > 
								     #userIds[]# 
								</iterate>
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="status"> 
								ho.ORDER_STATE IN
								<iterate property="status" open="(" close=")" conjunction="," > 
								     #status[]# 
								</iterate>
						</isNotEmpty>
						<isNotEmpty property="startTime" prepend="AND">
								<![CDATA[
								     ho.PAY_DATE >= #startTime#
								]]>      
						</isNotEmpty>
						<isNotEmpty property="endTime" prepend="AND">
								<![CDATA[
								     ho.PAY_DATE < #endTime#
								]]>      
						</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.recommendSaleMoneyForRecommendTeamSum -->
			 <select id="MS-ORDER-RECOMMEND-SALE-MONEY-FOR-RECOMMEND-TEAM-SUM" resultClass="java.util.HashMap">
	        SELECT
						<!-- 关于团队的总消费金额   -->
						SUM(
						(	SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho 
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) all_team_amount_sum,
						<!-- 会员销售金额 -->
						SUM(
						(	SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order  ho
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="unifyUserIds"> 
									ho.USER_ID NOT IN
									<iterate property="unifyUserIds" open="(" close=")" conjunction="," > 
								        	#unifyUserIds[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) u_buy_amount_sum,
						<!-- 关于团队的总消费人数 -->
						SUM(
						(	SELECT COUNT(DISTINCT ho.USER_ID) FROM hqyt_order ho 
							WHERE  ho.TEAM_ID = team.TEAM_ID
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) all_team_count_sum,
						<!-- 推荐人数 -->
						SUM(
						(	SELECT COUNT(1) FROM hqyt_user hu 
							WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID)
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       hu.GMT_CREATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) re_user_count_sum,
						<!-- 推荐消费人数  通过这个团队的成员邀请注册后有消费的人数-->
						SUM(
						(	SELECT COUNT(DISTINCT ho.USER_ID) FROM hqyt_order ho 
							WHERE ho.USER_ID IN 
							(SELECT USER_ID FROM hqyt_user hu WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID))
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) re_buy_count_sum,
						SUM(
						(	SELECT IFNULL(SUM( ho.REAL_ORDER_PRICE +  ho.REDUCE_AMOUNT_VOUCHER),0) FROM hqyt_order ho 
							WHERE ho.USER_ID IN 
							(SELECT USER_ID FROM hqyt_user hu WHERE hu.RECOMMEND_USER_ID IN (SELECT TEAM_USER_ID FROM hqyt_team_user htu WHERE htu.TEAM_ID = team.TEAM_ID))
							<isNotEmpty prepend="AND" property="status"> 
									ho.ORDER_STATE IN
									<iterate property="status" open="(" close=")" conjunction="," > 
								        	#status[]# 
								    </iterate>
							</isNotEmpty>
							<isNotEmpty property="startTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE >= #startTime#
								    ]]>      
							</isNotEmpty>
							<isNotEmpty property="endTime" prepend="AND">
								    <![CDATA[
								       ho.PAY_DATE < #endTime#
								    ]]>      
							</isNotEmpty>
						)
						) re_buy_amount_sum
					FROM
						hqyt_team team
					WHERE 1=1
					<isNotEmpty prepend="AND" property="teamIds"> 
							team.TEAM_ID IN
							<iterate property="teamIds" open="(" close=")" conjunction="," > 
						        	#teamIds[]# 
						    </iterate>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="reMsg">
						CONCAT_WS(&apos; &apos;,team.TEAM_ID,team.TEAM_NAME,team.ERP_NO) like "%$reMsg$%"
					</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.sumOrderAmount -->
			 <select id="MS-ORDER-SUM-ORDER-AMOUNT" resultClass="java.math.BigDecimal">
	        SELECT
		       IFNULL(SUM(REAL_ORDER_PRICE),0) orderMoney
			FROM hqyt_order
            WHERE 1=1
            <isNotEmpty property="orderNo" prepend="and">
	               ORDER_ID = #orderNo#
	        </isNotEmpty>
    </select>

</sqlMap>