<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_voucher -->
    <resultMap id="RM-VOUCHER" class="com.onway.fyapp.common.dal.dataobject.VoucherDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="voucherNo" column="VOUCHER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="amount.cent" column="AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="leftAmount.cent" column="LEFT_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="realAmount.cent" column="REAL_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sendTeamId" column="SEND_TEAM_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkStatus" column="CHECK_STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkUser" column="CHECK_USER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkDate" column="CHECK_DATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="checkMemo" column="CHECK_MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkStatusAcc" column="CHECK_STATUS_ACC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkUserAcc" column="CHECK_USER_ACC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="checkDateAcc" column="CHECK_DATE_ACC"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="checkMemoAcc" column="CHECK_MEMO_ACC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="cerNo" column="CER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="cerImg" column="CER_IMG"  javaType="java.lang.String" jdbcType="TEXT" />
		<result property="fromWay" column="FROM_WAY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="isSc" column="IS_SC"  javaType="boolean" jdbcType="BIT"  nullValue="false"/>
		<result property="gmtSc" column="GMT_SC"  javaType="java.util.Date" jdbcType="DATETIME" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisVoucherDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherList -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-LIST" resultClass="java.util.HashMap">
	        SELECT
					hv.VOUCHER_NO voucherNo,
					hv.AMOUNT amount,
					hv.LEFT_AMOUNT leftAmount,
					hv.REAL_AMOUNT realAmount,
					hv.MEMO memo,
					hv.CER_NO cerNo,
					hv.CER_IMG cerImg,
					hv.FROM_WAY fromWay,
					hv.GMT_CREATE gmtCreate,
					hv.GMT_MODIFIED gmtModified,
					<!-- 所属用户 -->
					hv.USER_ID hu_userId,
					hu.CELL hu_cell,
					IFNULL(hu.REAL_NAME, hu.NICK_NAME) hu_name,
					hu.SEX hu_sex,
					<!-- 所属门店 -->
					hv.SEND_TEAM_ID ht_teamId,
					ht.TEAM_NAME ht_teamName,
					ht.CELL ht_teamCell,
					ht.CHARGE_PERSON_NAME ht_chargeUser,
					ht.CHARGE_PERSON_CELL ht_chargeCell,
					<!-- 创建用户 -->
					hv.CREATER huc_userId,
					huc.CELL huc_cell,
					IFNULL(huc.REAL_NAME, huc.NICK_NAME) huc_name,
					huc.SEX huc_sex,
					<!-- 审核用户（业务员） -->
					hv.CHECK_USER hucc_userId,
					hucc.CELL hucc_cell,
					IFNULL(hucc.REAL_NAME, hucc.NICK_NAME) hucc_name,
					hucc.SEX hucc_sex,
					hv.CHECK_STATUS checkStatus,
					hv.CHECK_DATE checkDate,
					hv.CHECK_MEMO checkMemo,
					<!-- 审核用户（财务）） -->
					hv.CHECK_USER_ACC hucca_userId,
					hucca.CELL hucca_cell,
					IFNULL(hucca.REAL_NAME, hucca.NICK_NAME) hucca_name,
					hucca.SEX hucca_sex,
					hv.CHECK_STATUS_ACC checkStatusAcc,
					hv.CHECK_DATE_ACC checkDateAcc,
					hv.CHECK_MEMO_ACC checkMemoAcc
				FROM hqyt_voucher hv
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hv.FROM_WAY = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hv.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hv.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
				ORDER BY hv.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherListCount -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-LIST-COUNT" resultClass="int">
	        SELECT 
					COUNT(1)
				FROM hqyt_voucher hv
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hv.FROM_WAY = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		         <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hv.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hv.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryMyVoucherSumAmountTeam -->
			 <select id="MS-VOUCHER-QUERY-MY-VOUCHER-SUM-AMOUNT-TEAM" resultClass="java.util.HashMap">
	        SELECT 
			 	IFNULL(SUM(LEFT_AMOUNT),0) AS amount,
			 	hqyt_team.TEAM_NAME teamName
			 FROM 
			 	hqyt_voucher
			 LEFT JOIN hqyt_team ON hqyt_team.TEAM_ID = hqyt_voucher.SEND_TEAM_ID
			 WHERE 1 = 1 
			 <isNotEmpty prepend="and" property="userId"> 
			  	 hqyt_voucher.USER_ID = #userId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="teamId"> 
			  	 hqyt_voucher.SEND_TEAM_ID = #teamId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatus"> 
			  	 hqyt_voucher.CHECK_STATUS = #checkStatus#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatusAcc"> 
			  	 hqyt_voucher.CHECK_STATUS_ACC = #checkStatusAcc#
			 </isNotEmpty>
			 GROUP BY hqyt_voucher.SEND_TEAM_ID
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryMyVoucherSumAmount -->
			 <select id="MS-VOUCHER-QUERY-MY-VOUCHER-SUM-AMOUNT" resultClass="java.math.BigDecimal">
	        SELECT 
			 	IFNULL(SUM(LEFT_AMOUNT),0)
			 FROM 
			 	hqyt_voucher
			 WHERE 1 = 1 
			 <isNotEmpty prepend="and" property="userId"> 
			  	 USER_ID = #userId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="teamId"> 
			  	 SEND_TEAM_ID = #teamId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatus"> 
			  	 CHECK_STATUS = #checkStatus#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatusAcc"> 
			  	 CHECK_STATUS_ACC = #checkStatusAcc#
			 </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryMyVoucherSumAmountUserIds -->
			 <select id="MS-VOUCHER-QUERY-MY-VOUCHER-SUM-AMOUNT-USER-IDS" resultClass="java.math.BigDecimal">
	        SELECT 
			 	IFNULL(SUM(LEFT_AMOUNT),0)
			 FROM 
			 	hqyt_voucher
			 WHERE 1 = 1 
			 <isNotEmpty prepend="and" property="userIds"> 
					USER_ID IN 
				<iterate property="userIds" open="(" close=")" conjunction="," > 
						#userIds[]# 
				</iterate>
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="teamId"> 
			  	 SEND_TEAM_ID = #teamId#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatus"> 
			  	 CHECK_STATUS = #checkStatus#
			 </isNotEmpty>
			 <isNotEmpty prepend="and" property="checkStatusAcc"> 
			  	 CHECK_STATUS_ACC = #checkStatusAcc#
			 </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherSum -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-SUM" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(
					CASE WHEN
					hv.FROM_WAY = '1'
					THEN
					hv.AMOUNT
					ELSE 0
					END
					),0) amountSum,
					IFNULL(SUM(
					CASE WHEN
					hv.CHECK_STATUS = 'ENABLED' AND hv.CHECK_STATUS_ACC = 'ENABLED'
					THEN
					hv.LEFT_AMOUNT
					ELSE 0
					END
					),0) leftAmountSum,
					IFNULL(SUM(
					CASE WHEN
					hv.FROM_WAY = '1'
					THEN
					hv.REAL_AMOUNT
					ELSE 0
					END
					),0) realAmountSum
				FROM hqyt_voucher hv
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hv.FROM_WAY = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hv.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hv.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherRecordList -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-RECORD-LIST" resultClass="java.util.HashMap">
	        SELECT
					hv.VOUCHER_NO voucherNo,
					hv.AMOUNT amount,
					hv.LEFT_AMOUNT leftAmount,
					hv.REAL_AMOUNT realAmount,
					hv.MEMO memo,
					hv.CER_NO cerNo,
					hv.CER_IMG cerImg,
					hv.FROM_WAY fromWay,
					hv.GMT_CREATE gmtCreate,
					hv.GMT_MODIFIED gmtModified,
					<!-- 所属用户 -->
					hv.USER_ID hu_userId,
					hu.CELL hu_cell,
					IFNULL(hu.REAL_NAME, hu.NICK_NAME) hu_name,
					hu.SEX hu_sex,
					<!-- 所属门店 -->
					hv.SEND_TEAM_ID ht_teamId,
					ht.TEAM_NAME ht_teamName,
					ht.ERP_NO ht_teamErpNo,
					ht.CELL ht_teamCell,
					ht.CHARGE_PERSON_NAME ht_chargeUser,
					ht.CHARGE_PERSON_CELL ht_chargeCell,
					<!-- 创建用户 -->
					hv.CREATER huc_userId,
					huc.CELL huc_cell,
					IFNULL(huc.REAL_NAME, huc.NICK_NAME) huc_name,
					huc.SEX huc_sex,
					<!-- 审核用户（业务员） -->
					hv.CHECK_USER hucc_userId,
					hucc.CELL hucc_cell,
					IFNULL(hucc.REAL_NAME, hucc.NICK_NAME) hucc_name,
					hucc.SEX hucc_sex,
					hv.CHECK_STATUS checkStatus,
					hv.CHECK_DATE checkDate,
					hv.CHECK_MEMO checkMemo,
					<!-- 审核用户（财务）） -->
					hv.CHECK_USER_ACC hucca_userId,
					hucca.CELL hucca_cell,
					IFNULL(hucca.REAL_NAME, hucca.NICK_NAME) hucca_name,
					hucca.SEX hucca_sex,
					hv.CHECK_STATUS_ACC checkStatusAcc,
					hv.CHECK_DATE_ACC checkDateAcc,
					hv.CHECK_MEMO_ACC checkMemoAcc,
					hvr.RECORD_AMOUNT recordAmount,
					hvr.RECORD_LINK recordLink,
					hvr.RECORD_TYPE recordType
				FROM  hqyt_voucher hv
				LEFT JOIN hqyt_voucher_record hvr ON hv.VOUCHER_NO = hvr.VOUCHER_NO 
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hvr.RECORD_TYPE = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hvr.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hvr.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
				ORDER BY hv.GMT_CREATE DESC, hvr.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherRecordListCount -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-RECORD-LIST-COUNT" resultClass="int">
	        SELECT 
					COUNT(1)
				FROM  hqyt_voucher hv
				LEFT JOIN hqyt_voucher_record hvr ON hv.VOUCHER_NO = hvr.VOUCHER_NO
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hvr.RECORD_TYPE = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hvr.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hvr.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherRecordVoucehrNoList -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-RECORD-VOUCEHR-NO-LIST" resultClass="java.lang.String">
	        SELECT
					DISTINCT hv.VOUCHER_NO voucherNo
				FROM hqyt_voucher_record hvr
				LEFT JOIN hqyt_voucher hv ON hv.VOUCHER_NO = hvr.VOUCHER_NO 
				LEFT JOIN hqyt_user hu ON hu.USER_ID = hv.USER_ID 
				LEFT JOIN hqyt_team ht ON ht.TEAM_ID = hv.SEND_TEAM_ID 
				LEFT JOIN hqyt_user huc ON huc.USER_ID = hv.CREATER 
				LEFT JOIN hqyt_user hucc ON hucc.USER_ID = hv.CHECK_USER 
				LEFT JOIN hqyt_user hucca ON hucca.USER_ID = hv.CHECK_USER_ACC
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="fromWay"> 
					hvr.RECORD_TYPE = #fromWay#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatus"> 
					hv.CHECK_STATUS = #checkStatus#
				</isNotEmpty>
				<isNotEmpty prepend="and" property="checkStatusAcc"> 
					hv.CHECK_STATUS_ACC = #checkStatusAcc#
				</isNotEmpty>
				
		        <isNotEmpty prepend="and" property="userMsg">
					CONCAT_WS(&apos; &apos;,hu.USER_ID,hu.CELL,hu.NICK_NAME,hu.REAL_NAME) like "%$userMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="teamMsg">
					CONCAT_WS(&apos; &apos;,ht.TEAM_ID,ht.TEAM_NAME,ht.ERP_NO) like "%$teamMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="acerMsg">
					CONCAT_WS(&apos; &apos;,hucc.USER_ID,hucc.CELL,hucc.NICK_NAME,hucc.REAL_NAME) like "%$acerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="cwerMsg">
					CONCAT_WS(&apos; &apos;,hucca.USER_ID,hucca.CELL,hucca.NICK_NAME,hucca.REAL_NAME) like "%$cwerMsg$%"
				</isNotEmpty>
				
				<isNotEmpty prepend="and" property="createrMsg">
					CONCAT_WS(&apos; &apos;,huc.USER_ID,huc.CELL,huc.NICK_NAME,huc.REAL_NAME) like "%$createrMsg$%"
				</isNotEmpty>
				
				<isNotEmpty property="startDate" prepend="and">
		            <![CDATA[
		             	hvr.GMT_CREATE >=  #startDate#
		            ]]>        
		        </isNotEmpty>
		        
		        <isNotEmpty property="endDate" prepend="and">
		             <![CDATA[
		                hvr.GMT_CREATE <= #endDate#
		             ]]>      
		        </isNotEmpty>
		        
				ORDER BY hvr.GMT_CREATE DESC 
				<isNotEmpty property="offset"> 
					limit #offset#,#limit#
				</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisVoucherDAO.queryAllVoucherRecordSum -->
			 <select id="MS-VOUCHER-QUERY-ALL-VOUCHER-RECORD-SUM" resultClass="java.util.HashMap">
	        SELECT
					IFNULL(SUM(
					CASE WHEN
					hv.FROM_WAY = '1'
					THEN
					hv.AMOUNT
					ELSE 0
					END
					),0) amountSum,
					IFNULL(SUM(
					CASE WHEN
					hv.CHECK_STATUS = 'ENABLED' AND hv.CHECK_STATUS_ACC = 'ENABLED'
					THEN
					hv.LEFT_AMOUNT
					ELSE 0
					END
					),0) leftAmountSum,
					IFNULL(SUM(
					CASE WHEN
					hv.FROM_WAY = '1'
					THEN
					hv.REAL_AMOUNT
					ELSE 0
					END
					),0) realAmountSum
				FROM hqyt_voucher hv
		        WHERE 1 = 1 
		        <isNotEmpty prepend="and" property="voucehrNo"> 
				 	hv.VOUCHER_NO IN
					<iterate property="voucehrNo" open="(" close=")" conjunction="," > 
		        		#voucehrNo[]# 
		        	</iterate>
		    	</isNotEmpty>
    </select>

</sqlMap>