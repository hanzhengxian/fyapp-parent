<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table hqyt_stock_price -->
    <resultMap id="RM-STOCK-PRICE" class="com.onway.fyapp.common.dal.dataobject.StockPriceDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT UNSIGNED"  nullValue="0"/>
		<result property="goodsNo" column="GOODS_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="attrIds" column="ATTR_IDS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="attrNames" column="ATTR_NAMES"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="valueIds" column="VALUE_IDS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="valuees" column="VALUEES"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="imgSrc" column="IMG_SRC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="price.cent" column="PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="goodAmount.cent" column="GOOD_AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="point.cent" column="POINT"  javaType="long" jdbcType="DECIMAL" />
		<result property="pointRate" column="POINT_RATE"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="stock" column="STOCK"  javaType="double" jdbcType="DOUBLE UNSIGNED"  nullValue="0"/>
		<result property="sellNum" column="SELL_NUM"  javaType="double" jdbcType="DOUBLE UNSIGNED"  nullValue="0"/>
		<result property="type" column="TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="pickLimit" column="PICK_LIMIT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="barCode" column="BAR_CODE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="erpNo" column="ERP_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="payType" column="PAY_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="controlStock" column="CONTROL_STOCK"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delFlg" column="DEL_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="returnType" column="RETURN_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="returnValue" column="RETURN_VALUE"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisStockPriceDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisStockPriceDAO.insert -->
    <insert id="MS-STOCK-PRICE-INSERT">
    <![CDATA[
        insert into hqyt_stock_price(GOODS_NO,ATTR_IDS,ATTR_NAMES,VALUE_IDS,VALUEES,IMG_SRC,PRICE,GOOD_AMOUNT,POINT,POINT_RATE,STOCK,SELL_NUM,TYPE,PICK_LIMIT,BAR_CODE,ERP_NO,PAY_TYPE,CONTROL_STOCK,RETURN_TYPE,RETURN_VALUE,MEMO,GMT_CREATE,CREATER,GMT_MODIFIED,MODIFIER) values (#goodsNo#, #attrIds#, #attrNames#, #valueIds#, #valuees#, #imgSrc#, #price.cent#, #goodAmount.cent#, #point.cent#, #pointRate#, #stock#, #sellNum#, #type#, #pickLimit#, #barCode#, #erpNo#, #payType#, #controlStock#, #returnType#, #returnValue#, #memo#, CURRENT_TIMESTAMP, #creater#, CURRENT_TIMESTAMP, #modifier#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisStockPriceDAO.update -->
    <update id="MS-STOCK-PRICE-UPDATE">
    <![CDATA[
        update hqyt_stock_price set IMG_SRC=#imgSrc#, PRICE=#price.cent#, GOOD_AMOUNT=#goodAmount.cent#, POINT=#point.cent#, POINT_RATE=#pointRate#, STOCK=#stock#, PAY_TYPE=#payType#, ERP_NO=#erpNo#, BAR_CODE=#barCode#, PICK_LIMIT=#pickLimit#, CONTROL_STOCK=#controlStock#, RETURN_TYPE=#returnType#, RETURN_VALUE=#returnValue#, MEMO=#memo#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisStockPriceDAO.selectById -->
			 <select id="MS-STOCK-PRICE-SELECT-BY-ID" resultMap="RM-STOCK-PRICE">
	    <![CDATA[
        select * from hqyt_stock_price where (ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisStockPriceDAO.queryProStockPrice -->
			 <select id="MS-STOCK-PRICE-QUERY-PRO-STOCK-PRICE" resultClass="java.util.HashMap">
	        SELECT
		        sp.ID id,
				sp.GOODS_NO goodsNo,
				sp.ATTR_IDS attrIds,
				sp.ATTR_NAMES attrNames,
				sp.VALUE_IDS valueIds,
				sp.VALUEES valuees,
				sp.IMG_SRC imgSrc,
				sp.PRICE price,
				sp.GOOD_AMOUNT goodAmount,
				sp.POINT point,
				sp.POINT_RATE pointRate,
				sp.STOCK stock,
				sp.SELL_NUM sellNum,
				sp.TYPE type,
				sp.PICK_LIMIT pickLimit,
				sp.BAR_CODE barCode,
				sp.ERP_NO erpNo,
				sp.PAY_TYPE payType,
				sp.CONTROL_STOCK controlStock,
				sp.DEL_FLG delFlg,
				sp.MEMO memo,
				sp.GMT_CREATE gmtCreate,
				sp.GMT_MODIFIED gmtModified,
				sp.RETURN_TYPE returnType,
				sp.RETURN_VALUE returnValue,
		        scu.USERNAME creater,
				smu.USERNAME modifier
			FROM hqyt_stock_price sp
			LEFT JOIN sys_role_user scu ON scu.USER_ID = sp.CREATER
			LEFT JOIN sys_role_user smu ON smu.USER_ID = sp.MODIFIER
            WHERE 1=1
            <isNotEmpty property="productId" prepend="and">
	               sp.GOODS_NO = #productId#
	        </isNotEmpty>
	        <isNotEmpty property="delFlg" prepend="and">
	               sp.DEL_FLG = #delFlg#
	        </isNotEmpty>
	        <isNotEmpty property="type" prepend="and">
	               sp.TYPE = #type#
	        </isNotEmpty>
	        ORDER BY sp.GMT_CREATE DESC
	        <isNotEmpty property="offset">
                limit $offset$,$limit$
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisStockPriceDAO.queryProStockPriceCount -->
			 <select id="MS-STOCK-PRICE-QUERY-PRO-STOCK-PRICE-COUNT" resultClass="int">
	        SELECT
		        COUNT(1)
			FROM hqyt_stock_price sp
			LEFT JOIN sys_role_user scu ON scu.USER_ID = sp.CREATER
			LEFT JOIN sys_role_user smu ON smu.USER_ID = sp.MODIFIER
            WHERE 1=1
            <isNotEmpty property="productId" prepend="and">
	               sp.GOODS_NO = #productId#
	        </isNotEmpty>
	        <isNotEmpty property="delFlg" prepend="and">
	               sp.DEL_FLG = #delFlg#
	        </isNotEmpty>
	         <isNotEmpty property="type" prepend="and">
	               sp.TYPE = #type#
	        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisStockPriceDAO.updateStockByErpNo -->
    <update id="MS-STOCK-PRICE-UPDATE-STOCK-BY-ERP-NO">
    <![CDATA[
        update hqyt_stock_price set STOCK=#stock#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisStockPriceDAO.queryInfoByErpNo -->
			 <select id="MS-STOCK-PRICE-QUERY-INFO-BY-ERP-NO" resultMap="RM-STOCK-PRICE">
	    <![CDATA[
        select * from hqyt_stock_price where (ERP_NO = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisStockPriceDAO.delStockPrice -->
    <update id="MS-STOCK-PRICE-DEL-STOCK-PRICE">
    <![CDATA[
        update hqyt_stock_price set DEL_FLG=#delFlg#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisStockPriceDAO.checkProStockPrice -->
			 <select id="MS-STOCK-PRICE-CHECK-PRO-STOCK-PRICE" resultClass="int">
	        SELECT
		        COUNT(1)
			FROM hqyt_stock_price
            WHERE 1=1
            <isNotEmpty property="checkId" prepend="and">
	               ID &lt;&gt;  #checkId#
	        </isNotEmpty>
            <isNotEmpty property="productId" prepend="and">
	               GOODS_NO = #productId#
	        </isNotEmpty>
	         <isNotEmpty property="attrIds" prepend="and">
	               ATTR_IDS = #attrIds#
	        </isNotEmpty>
	         <isNotEmpty property="valueIds" prepend="and">
	               VALUE_IDS = #valueIds#
	        </isNotEmpty>
	        <isNotEmpty property="delFlg" prepend="and">
	               DEL_FLG = #delFlg#
	        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisStockPriceDAO.queryProStockPriceNotMap -->
			 <select id="MS-STOCK-PRICE-QUERY-PRO-STOCK-PRICE-NOT-MAP" resultMap="RM-STOCK-PRICE">
	        SELECT
		       *
			FROM hqyt_stock_price
            WHERE 1=1
            <isNotEmpty property="productId" prepend="and">
	               GOODS_NO = #productId#
	        </isNotEmpty>
	        <isNotEmpty property="delFlg" prepend="and">
	               DEL_FLG = #delFlg#
	        </isNotEmpty>
    </select>

</sqlMap>